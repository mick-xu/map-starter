!function(g,w,N){"use strict";var m="ht",q=g[m],C=q.Default,a=q.graph,o=C.getInternal(),F=o.ui(),v=F.NodeUI.prototype,M=F.ShapeUI.prototype,y=a.GraphView,h=y.prototype,d=F.EdgeUI.prototype,K=q.Node,U=q.Shape,x=q.Edge,z=q.Group,c=C.isTouchable,e=C.preventDefault,r=g.setTimeout,l=C.grow,i=C.isDragging,P=C.getDistance,Z=null,E=q.List,A="undefined"!=typeof Float32Array?Float32Array:Array,k=Math,D=k.PI,n="Crossing",T="No Crossing",G=D/2,s=2*D,L=k.atan2,I=k.sqrt,$=k.pow,Y=k.sin,X=k.cos,R=k.min,O=k.max,_=k.abs,V=k.ceil,t=k.round,p=C.unionPoint,Q=C.unionRect,b=C.containsPoint,B=C.clone,S="rgb(52, 152, 219)",W="red",u={northwest:0,north:1,northeast:2,west:7,east:3,southwest:6,south:5,southeast:4},J={width:400,height:100,comps:[{type:"shape",points:{func:function(){for(var z=[10,8,162,36,314,37,269,2,398,49,268,98,314,58,161,60,9,91,103,49,10,8],E=0;E<z.length;E++){var i=z[E];i=0===E%2?i/400*J.width:i/100*J.height,z[E]=i}return J.width>120&&(z[4]=J.width-26,z[6]=J.width-40,z[10]=J.width-40,z[12]=J.width-26,z[18]=33),z}},segments:[1,3,2,2,2,2,3,2,2],background:"white",gradient:"linear.east",gradientColor:"red"}]},j={width:300,height:300,comps:[{type:"circle",rect:[20,0,120,120],background:S,rotation:.61},{type:"circle",rect:[200,120,70,70],background:S,rotation:.61},{type:"circle",rect:[200,220,70,70],background:S,rotation:.61},{type:"shape",points:[80,60,80,155,200,155],borderWidth:20,borderColor:S},{type:"shape",points:[80,60,80,255,200,255],borderWidth:20,borderColor:S}]},f={width:300,height:300,comps:[{type:"shape",points:[114,239,115,106,112,73,149,73,149,73,175,73,177,105,179,261,178,302,147,307,98,308,83,307,72,276,73,260,72,81,74,29,115,21,191,21,221,22,224,53,223,238],segments:[1,2,3,2,3,2,3,2,4,2,3,2,3,2],borderWidth:20,borderColor:W,rotation:.61}]},H={width:300,height:300,comps:[{type:"circle",rect:[210,0,90,90],background:S},{type:"circle",rect:[0,210,90,90],background:S},{type:"shape",points:[255,45,45,255],borderWidth:20,borderColor:S}]},rs={width:300,height:300,comps:[{type:"shape",points:[20,20,280,280],borderWidth:30,borderColor:W},{type:"shape",points:[280,20,20,280],borderWidth:30,borderColor:W}]},kr={width:300,height:300,comps:[{type:"shape",points:[270,30,30,150,270,270],borderWidth:40,borderColor:S}]},Ah={width:300,height:300,comps:[{type:"shape",points:[30,30,270,150,30,270],borderWidth:40,borderColor:W}]},xq={width:300,height:300,comps:[{type:"rect",rect:[125.58,52.76,40,231.96],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[27.87,61.06,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:5.5},{type:"rect",rect:[113.36,61,150,30],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:.79}]},Nj={width:300,height:300,author:"",note:"",comps:[{type:"rect",rect:[135.15,38.76,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,2.35,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,115.72,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[31.71,167.62,240,15],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"rect",rect:[135.15,177.33,28.63,82.84],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000"},{type:"triangle",rect:[94.69,251.39,110,44.77],background:"rgb(0,0,0)",borderWidth:1,borderColor:"#000",rotation:3.14}]},Ai=function(O){var Q=O.touches[0];return Q?Q:O.changedTouches[0]},od=function(r,J,B,M){return L(M-J,B-r)},Rm=function(D,r){return{x:D.x*r,y:D.y*r}},cl=function(Q,Y){Q.each(function(U){return Q.isSelected(U)?Y(U):void 0})},ni=function(e,y){e.reverseEach(function(T){return e.isSelected(T)?y(T):void 0})},Yh=function(q,K,M){var b,X,n,F,N,o=this,m=K,J=o.gv;if(q instanceof U){n=q.getSegments();var O=J.getDataUI(q);N=O._55O.$15l,n&&n.size()||(n=Cd(N)),q.isClosePath()&&n.indexOf(5)<0&&(n=new E(n._as),n.add(5)),b=ve(q,O,m),X=N[b]}else{var W=J.getDataUI(q);N=uj(W,q.s("edge.points")),n=q.s("edge.segments"),n&&n.size()||(n=Cd(N)),N=N._as,b=ve(q,W,m),X=N[b]}if(n&&(F=n.get(m)),2===F||1===F||5===F){var V=N[b+1];5===F&&(V=N[0]);var L=vi(X,M,V);return L}return M},je=function(i,v,k,U){var q=v/2,$=k/2,j=Hh(i,-q,-$,U),K=Hh(i,q,-$,U),w=Hh(i,-q,$,U),t=Hh(i,q,$,U),o=Hh(i,0,-$,U),h=Hh(i,q,0,U),D=Hh(i,0,$,U),e=Hh(i,-q,0,U);return[j,K,w,t,o,h,D,e]},vi=function(l,L,j){var u={x:L.x-l.x,y:L.y-l.y},r={x:j.x-l.x,y:j.y-l.y},J=I($(j.x-l.x,2)+$(j.y-l.y,2)),B={x:r.x/J,y:r.y/J},k=u.x*B.x+u.y*B.y,g={x:B.x*k,y:B.y*k};return{x:l.x+g.x,y:l.y+g.y}},Hh=function(R,_,L,e){var P=X(e)*_-Y(e)*L,l=Y(e)*_+X(e)*L;return R?{x:R.x+P,y:R.y+l}:{x:P,y:l}},qr=function(m,z){return z>2*m?m:z/2},Xj=function(Z,$,w,u){var i=P(Z,$);return w=u?R(w,i):qr(w,i),i?w/=i:w=0,{x:Z.x+($.x-Z.x)*w,y:Z.y+($.y-Z.y)*w}},gd=function(b,S){var X,d,t=b.gv,e=b._data,u=e._40I,i=e._41I,q=e.s("edge.offset"),G=e.s("edge.source.position"),H=e.s("edge.target.position"),h=e.s("edge.source.offset.x"),Z=e.s("edge.source.offset.y"),K=e.s("edge.target.offset.x"),P=e.s("edge.target.offset.y"),U=e.s("edge.source.anchor.x"),O=e.s("edge.source.anchor.y"),B=e.s("edge.target.anchor.x"),g=e.s("edge.target.anchor.y");if(S?(X=o.getEdgeAgentPosition(t,u,G,h,Z,U,O),d=o.getEdgeAgentPosition(t,i,H,K,P,B,g)):(X=o.getEdgeAgentPosition(t,u,G,0,0,U,O),d=o.getEdgeAgentPosition(t,i,H,0,0,B,g)),"points"===e.s("edge.type")&&q&&!e.s("edge.center")&&X){var D=e.s("edge.points")||new E,p=D.size(),$=Xj(X,p?D.get(0):d,q,p),r=Xj(d,p?D.get(p-1):X,q,p);X=$,d=r}return[X,d]},uj=function($,C,s){var Y=$._78o,u=$._data,v=u.s("edge.type"),I=[Y.sourcePoint,Y.targetPoint];return"points"===v?s&&(I=gd($)):I=Y.center?v?s?gd($):gd($,!0):s?gd($):[Y.c1,Y.c2]:s?gd($):gd($,!0),C=new E(C?C._as:Z),C.add(I[0],0),C.add(I[1]),C},qh=function(o){return o=new E(o._as),o.removeAt(0),o.removeAt(o.size()-1),o},Cd=function(i){i._as||(i=new E(i));var v=new E;v.add(1);for(var r=1;r<i.size();r++)v.add(2);return v},Ie=function(X,R){return{x:(X.x+R.x)/2,y:(X.y+R.y)/2}},Cm=function(F,B){return{x:F.x+1*(B.x-F.x)/4,y:F.y+1*(B.y-F.y)/4}},Di=function(R,F){return{x:R.x+3*(F.x-R.x)/4,y:R.y+3*(F.y-R.y)/4}},al=function(M,t,k,A){var w=t.x+t.width/2,J=t.y+t.height/2,Q=I(w*w+J*J),V=L(J,w)+k;return{x:A.x+Q*X(V),y:A.y+Q*Y(V)}},ik=h.validateImpl,tr=h.isRectEditable,De=h.isPointEditable,Pg=h._42,fd=M._79o,bd=d._79o,zk=M._48O,_h=M._47O,jf=v._48O,rm=v._80o,_o=M._80o,gf=v.getSelectWidth,Jk=v._47O,xd=d._47O,dd=h.isEditable,Im=["northwest","north","northeast","east","southeast","south","southwest","west"],am=function(b,O,Y,r,t,C,y,T,U,X){var B=b.x,J=b.y,x=b.width,D=b.height,l={x:B+x/2,y:J+D/2};r=r||0,O=Hh(l,O.x-l.x,O.y-l.y,-r),y&&!T&&(O.x+=U,O.y+=X);var G=.01;if("northwest"===Y?(O.x+t>B+x-G&&(O.x=B+x-t-G),O.y+t>J+D-G&&(O.y=J+D-t-G),b=p(O,{x:B+x,y:J+D})):"north"===Y?(O.y+t>J+D-G&&(O.y=J+D-t-G),b=p({x:B,y:O.y},{x:B+x,y:J+D})):"northeast"===Y?(O.x<B+t+G&&(O.x=B+t+G),O.y+t>J+D-G&&(O.y=J+D-t-G),b=p({x:B,y:O.y},{x:O.x,y:J+D})):"west"===Y?(O.x+t>B+x-G&&(O.x=B+x-t-G),b=p({x:O.x,y:J},{x:B+x,y:J+D})):"east"===Y?(O.x<B+t+G&&(O.x=B+t+G),b=p({x:B,y:J},{x:O.x,y:J+D})):"southwest"===Y?(O.x+t>B+x-G&&(O.x=B+x-t-G),O.y<J+t+G&&(O.y=J+t+G),b=p({x:O.x,y:J},{x:B+x,y:O.y})):"south"===Y?(O.y<J+t+G&&(O.y=J+t+G),b=p({x:B,y:J},{x:B+x,y:O.y})):"southeast"===Y&&(O.x<B+t+G&&(O.x=B+t+G),O.y<J+t+G&&(O.y=J+t+G),b=p({x:B,y:J},O)),"keepRatio"===C&&(!y&&T||y&&!T)&&("northeast"===Y||"southeast"===Y||"northwest"===Y||"southwest"===Y)){var L=b.width,s=b.height,u=L/x,c=s/D,Q=R(u,c);b.width=x*Q,b.height=D*Q,"northeast"===Y?b.y=J+(D-b.height):"northwest"===Y?(b.y=J+(D-b.height),b.x=B+(x-b.width)):"southwest"===Y&&(b.x=B+(x-b.width))}b.x-=l.x,b.y-=l.y;var n=al(Z,b,r,l);return b.x=n.x-b.width/2,b.y=n.y-b.height/2,b},_n=function(R,n,y,C){var d=R.getRotation(),w=n,J=w.x,W=w.y,U=w.width,g=w.height,Y={x:J+w.width/2,y:W+w.height/2};C=Hh(Y,C.x-Y.x,C.y-Y.y,-d),"northwest"===y?w=p(C,{x:J+U,y:W+g}):"north"===y?w=p({x:J,y:C.y},{x:J+U,y:W+g}):"northeast"===y?w=p({x:J,y:C.y},{x:C.x,y:W+g}):"west"===y?w=p({x:C.x,y:W},{x:J+U,y:W+g}):"east"===y?w=p({x:J,y:W},{x:C.x,y:W+g}):"southwest"===y?w=p({x:C.x,y:W},{x:J+U,y:C.y}):"south"===y?w=p({x:J,y:W},{x:J+U,y:C.y}):"southeast"===y&&(w=p({x:J,y:W},C)),R.setRect(w),w.x-=Y.x,w.y-=Y.y;var q=al(R,w,d,Y);R.p(q.x,q.y)},Tf=function(t,d,m,c,v,X,B,H){var $=Z;X?($=Hh(Z,v.x-d.x,v.y-d.y,-m),$.x-=B.x,$.y-=B.y):$=Hh(Z,v.x-d.x,v.y-d.y,0);var T={x:d.x+$.x,y:d.y+$.y};H&&(T=H(T.x,T.y)),T.e=t.getPoints().get(c).e,t.setPoint(c,T);var W=t.getWidth(),N=t.getHeight(),r=t.p().x-W/2,k=t.p().y-N/2;r-=d.x,k-=d.y;var u=al(t,{x:r,y:k,width:W,height:N},m,d);t.p(u.x,u.y)},ve=function(q,S,j){var m,J;if(q instanceof U?(m=q.getPoints(),J=q.getSegments()):q instanceof x&&"points"===q.s("edge.type")&&(m=q.s("edge.points"),J=q.s("edge.segments"),m=uj(S,m)),J&&J.size()||(J=Cd(m)),q instanceof U&&q.isClosePath()&&J.indexOf(5)<0&&(J=new E(J._as),J.add(5)),J)for(var f=-1,b=0;b<J.size();b++){if(b===j)return f;var Y=J.get(b);1===Y?f+=1:2===Y?f+=1:3===Y?f+=2:4===Y&&(f+=3)}},Wq=function(u,Z,V){var Y,b;if(u instanceof U?(Y=u.getPoints(),b=u.getSegments()):u instanceof x&&"points"===u.s("edge.type")&&(Y=u.s("edge.points"),b=u.s("edge.segments"),Y=uj(Z,Y)),b&&b.size()||(b=Cd(Y)),b)for(var P=-1,A=0;A<b.size();A++){var d=b.get(A);if(1===d?P+=1:2===d?P+=1:3===d?P+=2:4===d&&(P+=3),P===V)return A}},wk=function(n,K){var Z=[n[0]-K[0],n[1]-K[1],n[2]-K[2]];return Z},Ao=function(){var B=new A(16);return B[0]=1,B[1]=0,B[2]=0,B[3]=0,B[4]=0,B[5]=1,B[6]=0,B[7]=0,B[8]=0,B[9]=0,B[10]=1,B[11]=0,B[12]=0,B[13]=0,B[14]=0,B[15]=1,B},ej=function(S,F){var l=S[0],o=S[1],G=S[2];return S[0]=F[0]*l+F[4]*o+F[8]*G+F[12],S[1]=F[1]*l+F[5]*o+F[9]*G+F[13],S[2]=F[2]*l+F[6]*o+F[10]*G+F[14],S},Dl=function(z,H){if(H){var g=Y(H),r=X(H),V=z[0],k=z[1],T=z[2],i=z[3],L=z[8],l=z[9],s=z[10],K=z[11];z[0]=V*r-L*g,z[1]=k*r-l*g,z[2]=T*r-s*g,z[3]=i*r-K*g,z[8]=V*g+L*r,z[9]=k*g+l*r,z[10]=T*g+s*r,z[11]=i*g+K*r}},Cn=function(f,I){for(var R=f.s("grid.row.count"),L=f.s("grid.column.count"),Y=0;R>Y;Y++)for(var H=0;L>H;H++){var j=f.getCellRect(Y,H);if(b(j,I))return{rowIndex:Y,columnIndex:H,rect:j,grid:f}}return null},Kp=function(F,x,c,m,q,w){var D={},W=c-F,C=m-x,u=k.sqrt(W*W+C*C),j=W/u,Q=C/u,L=(-F+q)*j+(-x+w)*Q;return 0>=L?(D.x=F,D.y=x):L>=u?(D.x=c,D.y=m):(D.x=F+L*j,D.y=x+L*Q),W=q-D.x,C=w-D.y,D.z=k.sqrt(W*W+C*C),D},ul=function(y,L){var R,i,t,p,o,_,J,E,j=y.getPoints(),W=y.getSegments(),C=y.p(),G=y.getRotation();if(!W||!(W.indexOf(3)>0||W.indexOf(4)>0)){for(E=0;E<=j.size()-1;E++)if(E===j.size()-1?(o=j.get(0),p=j.get(E)):(p=j.get(E),o=j.get(E+1)),p=Hh(C,p.x-C.x,p.y-C.y,G),o=Hh(C,o.x-C.x,o.y-C.y,G),_=Kp(p.x,p.y,o.x,o.y,L.x,L.y),J=_.z,J<(y.s("shape.border.width")||10)){i=p,t=o,R=E;break}if(R!=Z){var H=Kp(i.x,i.y,t.x,t.y,L.x,L.y),M=P(i,H);return{attachIndex:R,attachOffset:M}}}},Mg=function(u){for(var W=u._data,n=W.p(),H=W.getRotation(),N=W.getPoints(),A=Z,w=[],p=0;p<N.size();p++)A=N.get(p),w.push(Hh(n,A.x-n.x,A.y-n.y,H));u._55O.$15l=w};C.setImage("xeditinteractor_parentIcon",j),C.setImage("xeditinteractor_hostIcon",f),C.setImage("xeditinteractor_edgeIcon",H),C.setImage("xeditinteractor_removeIcon",rs),C.setImage("xeditinteractor_sourceIcon",kr),C.setImage("xeditinteractor_targetIcon",Ah),C.setImage("xeditinteractor_elevationIcon",xq),C.setImage("xeditinteractor_tallIcon",Nj),h._editPointSize=c?24:9,h._edgeHelpers=["parent","remove","source","target"],h._leftTopHelpers=["parent"],h._rightTopHelpers=["host"],h._leftBottomHelpers=["edge"],h._rightBottomHelpers=["remove"],Im=Im.concat(Im).concat(Im),d._79o=function(){var t=this,s=t.gv,J=s.getZoom(),T=s._editInteractor,q=bd.call(t);if(!q)return null;var f=gd(t,!0),M=f[0],v=f[1],Z={x:q.x,y:q.y,width:q.width,height:q.height},_=p(M,v);if(T instanceof a.XEditInteractor){Z=Q(Z,_);var i=t._55O,U=s.getEditPointSize()/J+2,g=0;i&&i._43O&&(g+=U/2,l(Z,g))}return Z},d._47O=function(U){var m=this,R=m.gv,G=R._editInteractor;G instanceof a.XEditInteractor||xd.call(m,U)},d.rectIntersects=function(M){var x=this,b=x._data,q=x.gv,j=q.getZoom(),p=x._55O,P=q._editInteractor;if(P instanceof a.XEditInteractor&&q.isEditable(b)&&p&&p._43O&&"points"===b.s("edge.type")){var O=b.s("edge.points"),B=b.s("edge.segments");O=uj(x,O),B&&B.size()||(B=Cd(O)),O=O._as;var f=!1,_=c?5:1,D=M.x+_,F=M.y+_,m={x:D,y:F};if(P._edge===b&&P._hoverSegmentIndex>=0){var d=q._editInteractor._hoverSegmentIndex,Y=B.get(d),t=ve(b,x,d),C=Z;if(t!=Z&&t>=0){var W=O[t],w=q.getSegmentHoverWidth()/j;if(2===Y||1===Y){var z=O[t+1];C=Ng(new kb(W.x,W.y),new kb(z.x,z.y),new kb(m.x-w,m.y-w),new kb(m.x+2*w,m.y+2*w)),C.$62l===n&&(f=!0)}else if(3===Y){var l=O[t+1],z=O[t+2];C=qs(new kb(W.x,W.y),new kb(l.x,l.y),new kb(z.x,z.y),new kb(m.x-w,m.y-w),new kb(m.x+2*w,m.y+2*w)),C.$62l===n&&(f=!0)}else if(4===Y){var u=O[t+1],Q=O[t+2];z=O[t+3],C=Po(new kb(W.x,W.y),new kb(u.x,u.y),new kb(Q.x,Q.y),new kb(z.x,z.y),new kb(m.x-w,m.y-w),new kb(m.x+2*w,m.y+2*w)),C.$62l===n&&(f=!0)}}}if(f)return!0}return Z},M._47O=function(k){var C=this,F=C.gv,u=F._editInteractor;u instanceof a.XEditInteractor||_h.call(C,k)},M.rectIntersects=function(e){var l=this,Y=l._data,V=l.gv,k=V.getZoom(),r=l._55O,$=V._editInteractor;if($ instanceof a.XEditInteractor&&V.isEditable(Y)&&r&&r._43O){var L=r.$15l,P=!1,g=c?5:1,F=e.x+g,T=e.y+g,W={x:F,y:T};if(L&&L.length===Y.getPoints().size()||(Mg(l),L=r.$15l),$._shape===Y&&$._hoverSegmentIndex>=0){var _=Y.getSegments();_&&_.size()||(_=Cd(L));var s=V._editInteractor._hoverSegmentIndex,G=_.get(s),q=ve(Y,l,s),D=Z;if(q!=Z&&q>=0){var b=L[q],d=V.getSegmentHoverWidth()/k;if(2===G||1===G){var X=L[q+1];D=Ng(new kb(b.x,b.y),new kb(X.x,X.y),new kb(W.x-d,W.y-d),new kb(W.x+2*d,W.y+2*d)),D.$62l===n&&(P=!0)}else if(3===G){var O=L[q+1],X=L[q+2];D=qs(new kb(b.x,b.y),new kb(O.x,O.y),new kb(X.x,X.y),new kb(W.x-d,W.y-d),new kb(W.x+2*d,W.y+2*d)),D.$62l===n&&(P=!0)}else if(4===G){var t=L[q+1],j=L[q+2];X=L[q+3],D=Po(new kb(b.x,b.y),new kb(t.x,t.y),new kb(j.x,j.y),new kb(X.x,X.y),new kb(W.x-d,W.y-d),new kb(W.x+2*d,W.y+2*d)),D.$62l===n&&(P=!0)}}}if(P)return!0}return Z},M._48O=function(){var T=this,m=T.gv,X=m._editInteractor;X instanceof a.XEditInteractor?(v._48O.call(T),T._55O._43O&&Mg(T)):zk.call(T)},M._79o=function(){var J=this,t=J.gv,d=t.getZoom(),s=t._editInteractor,A=fd.call(J);if(A){var u={x:A.x,y:A.y,width:A.width,height:A.height};if(s instanceof a.XEditInteractor){var w=J._55O,b=t.getEditPointSize()/d+2,h=0;w&&w._43O&&(h+=b/2,l(u,h))}return u}},v._47O=function(U){var b=this,R=b.gv,x=R._editInteractor;if(x instanceof a.XEditInteractor);else{var h=b._55O;h&&h._98o&&Jk.call(b,U)}},v.getSelectWidth=function(){var $=this,_=$.gv,g=_._editInteractor,T=$._data;return _.isEditable(T)&&g instanceof a.XEditInteractor?0:gf.call($)},v._80o=function(F){var I=this,R=I.gv._editInteractor;if(rm.call(I,F),R&&R._debug){F.save(),F.beginPath(),F.lineWidth=1,F.strokeStyle="green";var K=I._79o();K&&(F.rect(K.x,K.y,K.width,K.height),F.stroke()),F.restore()}},M._80o=function(x){var H=this,W=H.gv._editInteractor;if(_o.call(H,x),W&&W._debug){x.save(),x.beginPath(),x.lineWidth=1,x.strokeStyle="green";var q=H._79o();x.rect(q.x,q.y,q.width,q.height),x.stroke(),x.restore()}},v._48O=function(){var D=this,G=D.gv,C=D._data,L=G._editInteractor,O=D._55O,m=C.p(),f=C.getRotation();if(L instanceof a.XEditInteractor){if(O._42O){var p=je(m,C.getWidth(),C.getHeight(),f),H=p[0],g=p[1],J=p[2],u=p[3],t=p[4],c=p[5],x=p[6],q=p[7];O.$45l=[H,t,g,c,u,x,J,q]}}else jf.call(D)},h.getResizeMode=function(){return this.$25l||"normal"},h.setResizeMode=function(g){var C=this.$25l;this.$25l=g,this.fp("resizeMode",C,g)},h.getSnapAngle=function(){return this.$26l||Math.PI/36},h.setSnapAngle=function(F){var w=this.$26l;this.$26l=F,this.fp("snapAngle",w,F)},h.getSnapSpacing=function(){return this.$27l},h.setSnapSpacing=function(Q){var W=this.$27l;this.$27l=Q,this.fp("snapSpacing",W,Q)},h.getPointSnapSpacing=function(){return this._pointSnapSpacing},h.setPointSnapSpacing=function(h){var X=this._pointSnapSpacing;this._pointSnapSpacing=h,this.fp("pointSnapSpacing",X,h)},h.setHelperEditableFunc=function(o){var H=this._helperEditableFunc;this._helperEditableFunc=o,this.fp("helperEditableFunc",H,o)},h.getHelperEditableFunc=function(){return this._helperEditableFunc},h.setLeftTopHelpers=function(Z){var f=this._leftTopHelpers;this._leftTopHelpers=Z,this.fp("leftTopHelpers",f,Z)},h.getLeftTopHelpers=function(){return this._leftTopHelpers},h.setLeftTopHelpersAlign=function(N){var j=this._leftTopHelpersAlign;this._leftTopHelpersAlign=N,this.fp("leftTopHelpersAlign",j,N)},h.getLeftTopHelpersAlign=function(){return this._leftTopHelpersAlign},h.setRightTopHelpers=function(x){var Y=this._rightTopHelpers;this._rightTopHelpers=x,this.fp("rightTopHelpers",Y,x)},h.getRightTopHelpers=function(){return this._rightTopHelpers},h.setRightTopHelpersAlign=function(_){var o=this._rightTopHelpersAlign;this._rightTopHelpersAlign=_,this.fp("rightTopHelpersAlign",o,_)},h.getRightTopHelpersAlign=function(){return this._rightTopHelpersAlign},h.setLeftBottomHelpers=function(U){var Q=this._leftBottomHelpers;this._leftBottomHelpers=U,this.fp("leftBottomHelpers",Q,U)},h.getLeftBottomHelpers=function(){return this._leftBottomHelpers},h.setLeftBottomHelpersAlign=function(V){var M=this._leftBottomHelpersAlign;this._leftBottomHelpersAlign=V,this.fp("leftBottomHelpersAlign",M,V)},h.getLeftBottomHelpersAlign=function(){return this._leftBottomHelpersAlign},h.setRightBottomHelpers=function(W){var P=this._rightBottomHelpers;this._rightBottomHelpers=W,this.fp("rightBottomHelpers",P,W)},h.getRightBottomHelpers=function(){return this._rightBottomHelpers},h.setRightBottomHelpersAlign=function(s){var Q=this._rightBottomHelpersAlign;this._rightBottomHelpersAlign=s,this.fp("rightBottomHelpersAlign",Q,s)},h.getRightBottomHelpersAlign=function(){return this._rightBottomHelpersAlign},h.setEdgeHelpers=function(H){var n=this._edgeHelpers;this._edgeHelpers=H,this.fp("edgeHelpers",n,H)},h.getEdgeHelpers=function(){return this._edgeHelpers},h.isHelperEditable=function(e,n){return e instanceof x&&("host"===n||"edge"===n||"elevation"===n||"tall"===n)?!1:e instanceof K&&("source"===n||"target"===n)?!1:"pointElevation"===n?this._helperEditableFunc?this._helperEditableFunc(e,n):!1:this._helperEditableFunc?this._helperEditableFunc(e,n):!0},h.getEditHelperSize=function(){return this._editHelperSize||(c?28:16)},h.setEditHelperSize=function(P){var z=this._editHelperSize;this._editHelperSize=P,this.fp("editHelperSize",z,P)},h.getEditRectBorderColor=function(){return this.$28l||"rgb(0, 168, 255)"},h.setEditRectBorderColor=function(I){var _=this.$28l;this.$28l=I,this.fp("editRectBorderColor",_,I)},h.getNodeBorderColor=function(){return this.$29l||"#1ABC9C"},h.setNodeBorderColor=function(Z){var r=this.$29l;this.$29l=Z,this.fp("nodeBorderColor",r,Z)},h.getEditRectBorderStyle=function(){return this.$30l||"dashed"},h.setEditRectBorderStyle=function(u){var H=this.$30l;this.$30l=u,this.fp("editRectBorderStyle",H,u)},h.getControlPointBackground=function(){return this.$31l||"#ff0"},h.setControlPointBackground=function(o){var x=this.$31l;this.$31l=o,this.fp("controlPointBackground",x,o)},h.getControlPointBorderColor=function(){return this.$32l||this._editPointBorderColor},h.setControlPointBorderColor=function(r){var Z=this.$32l;this.$32l=r,this.fp("controlPointBorderColor",Z,r)},h.getJoinPointBackground=function(){return this.$33l||this._editPointBackground},h.setJoinPointBackground=function(E){var I=this.$33l;this.$33l=E,this.fp("joinPointBackground",I,E)},h.getJoinPointBorderColor=function(){return this.$34l||this._editPointBorderColor},h.setJoinPointBorderColor=function(b){var N=this.$34l;this.$34l=b,this.fp("joinPointBorderColor",N,b)},h.getDirectionLineColor=function(){return this.$35l||"#888"},h.setDirectionLineColor=function(v){var d=this.$35l;this.$35l=v,this.fp("directionLineColor",d,v)},h.getSegmentHoverColor=function(){return this.$36l||"rgba(255, 0, 0, 0.3)"},h.setSegmentHoverColor=function(i){var M=this.$36l;this.$36l=i,this.fp("segmentHoverColor",M,i)},h.getSegmentHoverWidth=function(){return this.$22l||(c?16:8)},h.setSegmentHoverWidth=function(i){var k=this.$22l;this.$22l=i,this.fp("segmentHoverWidth",k,i)},h.getSnapPointBorderColor=function(){return this.$38l||"#f00"},h.setSnapPointBorderColor=function(y){var k=this.$38l;this.$38l=y,this.fp("snapPointBorderColor",k,y)},h.getEditRectPadding=function(){return this.$39l!=Z?this.$39l:6},h.setEditRectPadding=function(o){var $=this.$39l;this.$39l=o,this.fp("editRectPading",$,o)},h.isRectEditable=function(m){var V=this,J=V._editInteractor;return J instanceof a.XEditInteractor?V._rectEditableFunc?V._rectEditableFunc(m):!0:tr.call(V,m)},h.isPointEditable=function(F){var H=this,_=H._editInteractor;return _ instanceof a.XEditInteractor?H._pointEditableFunc?H._pointEditableFunc(F):!0:De.call(H,F)},h.validateImpl=function(){var x=this,b=x.$14l,J=x._editInteractor;if(b){var L=x.getWidth(),_=x.getHeight();(L!==b.clientWidth||_!==b.clientHeight)&&(J&&(J._68I=1),o.setCanvas(b,L,_),x._32I=1)}ik.call(this)},h.isEditable=function(p){var s=dd.call(this,p),e=this._editInteractor;if(e instanceof a.XEditInteractor&&p instanceof x){if(!p.s("2d.editable"))return!1;var T=this.getEditableFunc();s=T?T(p):!0}return s},h._42=function(v,j){var L=this,q=L._editInteractor;Pg.call(L,v,j),q instanceof a.XEditInteractor&&q._68I&&q._42()},h.isSnapPoint=function(){return!0};var sc=function(a){arguments.length>0&&this.$58l(a)},tl=sc.prototype;tl.$58l=function(b){this.$62l=b,this.points=new Array},tl.$56l=function(J){this.points.push(J)},tl.$57l=function(u){this.points=this.points.concat(u)};var kb=function(P,M){arguments.length>0&&this.$58l(P,M)},Ad=kb.prototype;Ad.$58l=function(e,s){this.x=e,this.y=s},Ad.add=function(o){return new kb(this.x+o.x,this.y+o.y)},Ad.addEquals=function(i){return this.x+=i.x,this.y+=i.y,this},Ad.$55l=function(v){return new kb(this.x*v,this.y*v)},Ad.eq=function(O){return this.x==O.x&&this.y==O.y},Ad.lt=function(d){return this.x<d.x&&this.y<d.y},Ad.lte=function(E){return this.x<=E.x&&this.y<=E.y},Ad.gt=function(H){return this.x>H.x&&this.y>H.y},Ad.gte=function(e){return this.x>=e.x&&this.y>=e.y},Ad.lerp=function(i,q){return new kb(this.x+(i.x-this.x)*q,this.y+(i.y-this.y)*q)},Ad.distanceFrom=function(F){var Q=this.x-F.x,o=this.y-F.y;return I(Q*Q+o*o)},Ad.min=function(S){return new kb(R(this.x,S.x),R(this.y,S.y))},Ad.max=function(F){return new kb(O(this.x,F.x),O(this.y,F.y))},Ad.toString=function(){return this.x+","+this.y};var Ap=function(){this.$58l(arguments)},vd=Ap.prototype;Ap.TO=1e-6,Ap.AC=6,vd.$58l=function(b){this.co=new Array;for(var I=b.length-1;I>=0;I--)this.co.push(b[I])},vd.$55l=function(z){for(var Q=new Ap,v=0;v<=this.$50l()+z.$50l();v++)Q.co.push(0);for(var v=0;v<=this.$50l();v++)for(var F=0;F<=z.$50l();F++)Q.co[v+F]+=this.co[v]*z.co[F];return Q},vd.$59l=function(){for(var l=this.$50l();l>=0&&_(this.co[l])<=Ap.TO;l--)this.co.pop()},vd.$50l=function(){return this.co.length-1},vd.$51l=function(){var E;switch(this.$59l(),this.$50l()){case 0:E=new Array;break;case 1:E=this.$52l();break;case 2:E=this.$53l();break;case 3:E=this.$54l();break;case 4:E=this.$63l();break;default:E=new Array}return E},vd.$52l=function(){var r=new Array,z=this.co[1];return 0!=z&&r.push(-this.co[0]/z),r},vd.$53l=function(){var h=new Array;if(2==this.$50l()){var F=this.co[2],K=this.co[1]/F,$=this.co[0]/F,U=K*K-4*$;if(U>0){var q=I(U);h.push(.5*(-K+q)),h.push(.5*(-K-q))}else 0==U&&h.push(.5*-K)}return h},vd.$63l=function(){var m=new Array;if(4==this.$50l()){var Y=this.co[4],s=this.co[3]/Y,G=this.co[2]/Y,h=this.co[1]/Y,p=this.co[0]/Y,S=new Ap(1,-G,s*h-4*p,-s*s*p+4*G*p-h*h).$54l(),t=S[0],C=s*s/4-G+t;if(_(C)<=Ap.TO&&(C=0),C>0){var T=I(C),k=3*s*s/4-T*T-2*G,j=(4*s*G-8*h-s*s*s)/(4*T),J=k+j,H=k-j;if(_(J)<=Ap.TO&&(J=0),_(H)<=Ap.TO&&(H=0),J>=0){var E=I(J);m.push(-s/4+(T+E)/2),m.push(-s/4+(T-E)/2)}if(H>=0){var E=I(H);m.push(-s/4+(E-T)/2),m.push(-s/4-(E+T)/2)}}else if(0>C);else{var j=t*t-4*p;if(j>=-Ap.TO){if(0>j&&(j=0),j=2*I(j),k=3*s*s/4-2*G,k+j>=Ap.TO){var O=I(k+j);m.push(-s/4+O/2),m.push(-s/4-O/2)}if(k-j>=Ap.TO){var O=I(k-j);m.push(-s/4+O/2),m.push(-s/4-O/2)}}}}return m},vd.$54l=function(){var t=new Array;if(3==this.$50l()){var g=this.co[3],J=this.co[2]/g,j=this.co[1]/g,u=this.co[0]/g,o=(3*j-J*J)/3,S=(2*J*J*J-9*j*J+27*u)/27,U=J/3,P=S*S/4+o*o*o/27,d=S/2;if(_(P)<=Ap.TO&&(P=0),P>0){var r,F,f=I(P);r=-d+f,F=r>=0?$(r,1/3):-$(-r,1/3),r=-d-f,r>=0?F+=$(r,1/3):F-=$(-r,1/3),t.push(F-U)}else if(0>P){var i=I(-o/3),Z=L(I(-P),-d)/3,E=X(Z),c=Y(Z),w=I(3);t.push(2*i*E-U),t.push(-i*(E+w*c)-U),t.push(-i*(E-w*c)-U)}else{var r;r=d>=0?-$(d,1/3):$(-d,1/3),t.push(2*r-U),t.push(-r-U)}}return t};var gl=function(x,L){arguments.length>0&&this.$58l(x,L)},fj=gl.prototype;fj.$58l=function(E,s){this.x=E,this.y=s},fj.length=function(){return I(this.x*this.x+this.y*this.y)},fj.$60l=function(G){return this.x*G.x+this.y*G.y};var Pd=function(m,u,f,V){var G,k=(V.x-f.x)*(m.y-f.y)-(V.y-f.y)*(m.x-f.x),_=(u.x-m.x)*(m.y-f.y)-(u.y-m.y)*(m.x-f.x),W=(V.y-f.y)*(u.x-m.x)-(V.x-f.x)*(u.y-m.y);if(0!=W){var v=k/W,M=_/W;v>=0&&1>=v&&M>=0&&1>=M?(G=new sc(n),G.points.push(new kb(m.x+v*(u.x-m.x),m.y+v*(u.y-m.y)))):G=new sc(T)}else G=0==k||0==_?new sc("C"):new sc("P");return G},xr=function(H,j,e,r,$){var x,X,Z,L,c,z,R,l=r.min($),A=r.max($),I=new sc(T);x=j.$55l(-2),Z=H.add(x.add(e)),x=H.$55l(-2),X=j.$55l(2),L=x.add(X),c=new kb(H.x,H.y),R=new gl(r.y-$.y,$.x-r.x),z=r.x*$.y-$.x*r.y;for(var q=new Ap(R.$60l(Z),R.$60l(L),R.$60l(c)+z).$51l(),Q=0;Q<q.length;Q++){var F=q[Q];if(F>=0&&1>=F){var f=H.lerp(j,F),G=j.lerp(e,F),K=f.lerp(G,F);r.x==$.x?l.y<=K.y&&K.y<=A.y&&(I.$62l=n,I.$56l(K)):r.y==$.y?l.x<=K.x&&K.x<=A.x&&(I.$62l=n,I.$56l(K)):K.gte(l)&&K.lte(A)&&(I.$62l=n,I.$56l(K))}}return I},qs=function(s,c,G,I,C){var o=I.min(C),g=I.max(C),J=new kb(g.x,o.y),S=new kb(o.x,g.y),O=xr(s,c,G,o,J),t=xr(s,c,G,J,g),E=xr(s,c,G,g,S),m=xr(s,c,G,S,o),e=new sc(T);return e.$57l(O.points),e.$57l(t.points),e.$57l(E.points),e.$57l(m.points),e.points.length>0&&(e.$62l=n),e},Zq=function(G,S,c,s,I,r){var p,e,F,v,b,y,u,m,P,O,V=I.min(r),g=I.max(r),Y=new sc(T);p=G.$55l(-1),e=S.$55l(3),F=c.$55l(-3),v=p.add(e.add(F.add(s))),b=new gl(v.x,v.y),p=G.$55l(3),e=S.$55l(-6),F=c.$55l(3),v=p.add(e.add(F)),y=new gl(v.x,v.y),p=G.$55l(-3),e=S.$55l(3),F=p.add(e),u=new gl(F.x,F.y),m=new gl(G.x,G.y),O=new gl(I.y-r.y,r.x-I.x),P=I.x*r.y-r.x*I.y;for(var w=new Ap(O.$60l(b),O.$60l(y),O.$60l(u),O.$60l(m)+P).$51l(),h=0;h<w.length;h++){var H=w[h];if(H>=0&&1>=H){var D=G.lerp(S,H),$=S.lerp(c,H),i=c.lerp(s,H),R=D.lerp($,H),K=$.lerp(i,H),B=R.lerp(K,H);I.x==r.x?V.y<=B.y&&B.y<=g.y&&(Y.$62l=n,Y.$56l(B)):I.y==r.y?V.x<=B.x&&B.x<=g.x&&(Y.$62l=n,Y.$56l(B)):B.gte(V)&&B.lte(g)&&(Y.$62l=n,Y.$56l(B))}}return Y},Po=function(C,L,i,j,E,V){var d=E.min(V),e=E.max(V),W=new kb(e.x,d.y),O=new kb(d.x,e.y),t=Zq(C,L,i,j,d,W),x=Zq(C,L,i,j,W,e),b=Zq(C,L,i,j,e,O),v=Zq(C,L,i,j,O,d),u=new sc(T);return u.$57l(t.points),u.$57l(x.points),u.$57l(b.points),u.$57l(v.points),u.points.length>0&&(u.$62l=n),u},Ng=function(Q,k,e,y){var E=e.min(y),w=e.max(y),c=new kb(w.x,E.y),O=new kb(E.x,w.y),u=Pd(E,c,Q,k),$=Pd(c,w,Q,k),W=Pd(w,O,Q,k),C=Pd(O,E,Q,k),F=new sc(T);return F.$57l(u.points),F.$57l($.points),F.$57l(W.points),F.$57l(C.points),F.points.length>0&&(F.$62l=n),F},Qg=a.XEditInteractor=function(N){var V=this,e=V._view=document.createElement("canvas");e.className="editCanvas",e.style.position="absolute",Qg.superClass.constructor.call(V,N)};C.def(Qg,a.Interactor,{ms_edit:1,setUp:function(){var s=this,F=s.gv,k=F.getView(),I=s._view;Qg.superClass.setUp.call(s),F.setEditInteractor(s),F.$14l=I,F._79O?k.insertBefore(I,F._79O):k.appendChild(I);var N=s.$49l=s.$11l.bind(s);F.dm().md(N),F.sm().ms(N),F.mp(N)},tearDown:function(){var j=this,e=j.gv,c=e.getView(),s=j.$49l;Qg.superClass.tearDown.call(j),e.setEditInteractor(Z),e.$14l=Z,c.removeChild(j._view),e.dm().umd(s),e.sm().ums(s),e.ump(s)},clear:function(){var Z=this,P=Z.gv;delete Z._hoverSegmentIndex,delete Z._edge,delete Z._shape,delete P._editing,delete Z.$10l,delete Z.$13l,delete Z.$9l,delete Z._removePointIndex,delete Z._lp,Z.$12l="",delete Z.$40l,delete Z.$67l,delete Z.$72l,delete Z.$73l,delete Z.$75l,delete Z.$1l,delete Z.$3l,delete Z.$2l,delete Z.$92l,delete Z.$93l,delete Z.$94l,Z.clearDragging()},handle_keydown:function(Y){this.$48l!==Y.shiftKey&&(this.$48l=Y.shiftKey,this.handle_mousemove(Y,N,!0))},handle_keyup:function(K){this.$48l!==K.shiftKey&&(this.$48l=K.shiftKey,this.handle_mousemove(K,N,!0))},handle_touchstart:function(Q){this.handle_mousemove(Q),this.handle_mousedown(Q)},handle_mousedown:function(n){e(n);var M=this,b=M.$13l,D=M.gv,J=D.dm(),i=D.sm(),S=D.getZoom(),H=D.lp(n),O=C.isDoubleClick(n),t=C.isLeftButton(n),l=M.$7l,x=M._shape,A=M._hoverSegmentIndex,$=M._edge,p=M.$87l,k=M.$88l,F=function(){M._68I||p===M.$87l&&k===M.$88l||M.$43l()};if(7!==M.$67l&&(delete M.$87l,delete M.$88l),t&&(x||$)&&A>=0&&O&&(x&&i.contains(x)||$&&i.contains($))){var w=Yh.call(M,x||$,A,H);return M.addShapePoint(x||$,A,w),r(function(){M.handle_mousemove(n)},40),void 0}if(t&&(x||$)&&M._removePointIndex>=0&&O)return M.removeShapePoint(),M.$5l=1,r(function(){M.handle_mousemove(n)},40),void 0;if(!t||!D._editing)return F(),void 0;if(x&&b>=0){var f=x.getPoints().get(b),E=x.p(),y=Hh(E,f.x-E.x,f.y-E.y,-l+x.getRotation());h=Hh(E,H.x-E.x,H.y-E.y,-l),M.$24l={x:h.x-y.x,y:h.y-y.y},M.startDragging(n),J.beginTransaction(),M.fi({kind:"beginEditPoint",event:n,data:x,index:b}),M.$88l=b,M.$87l=x}else if(M.$10l){var g=D.sm().getSelection(),_=M.$6l,m=M.$1l={},T=M.$3l={},I=M.$16l[u[M.$10l]],q={x:_.x,y:_.y},G={x:_.x+_.width/2,y:_.y+_.height/2};M.$24l={x:H.x-I.x/S,y:H.y-I.y/S},M.$2l=B(M.$8l),M.$4l=B(_),g.each(function(P){if(P instanceof K){var v=P.p(),U=P.getWidth(),H=P.getHeight(),V=Hh(G,v.x-G.x,v.y-G.y,-l);m[P.getId()]={x:v.x-U/2,y:v.y-H/2,width:U,height:H},T[P.getId()]={x:(V.x-q.x)/_.width,y:(V.y-q.y)/_.height}}}),M.startDragging(n),J.beginTransaction(),M.fi({kind:"beginEditRect",event:n,direction:M.$10l})}else if($&&b>=0){var d=uj(D.getDataUI($),$.s("edge.points")),f=d.get(b);M.$24l={x:H.x-f.x,y:H.y-f.y},M.startDragging(n),J.beginTransaction(),M.fi({kind:"beginEditPoint",event:n,data:$,index:b}),M.$88l=b,M.$87l=$}else if(M.$40l){var _=M.$6l,G={x:_.x+_.width/2,y:_.y+_.height/2},o=B(M.$23l);o.x/=S,o.y/=S;var v=Hh(G,o.x-G.x,o.y-G.y,-l),h=Hh(G,H.x-G.x,H.y-G.y,-l);M.$24l={x:h.x-v.x,y:h.y-v.y},M.startDragging(n),J.beginTransaction(),M.fi({kind:"beginEditRotation",event:n,data:M._rotationNode})}else if([1,2,3,5,6,7,8,9].indexOf(M.$67l)>=0){var c=M.$67l;(7===c||8===c||9===c)&&J.beginTransaction(),M.startDragging(n)}else if(M.$71l&&O&&M.$79l(M.$71l,H)){var Z=i.toSelection();J.beginTransaction(),Z.each(function(t){J.remove(t)}),J.endTransaction()}F()},$11l:function(){var s=this,y=s.gv;y._editing&&(s.$13l==Z||s._shape==Z&&s._edge==Z)&&(s.$73l==Z||1!==s.$67l&&5!==s.$67l&&6!==s.$67l)||(s.$5l=1),s._68I=1},$46l:function(v){var h=this,$=h.gv,g=$.lp(v),C=[];return ni($,function(P){var B=$.getDataUI(P);if(B){var E=B._79o();b(E,g)&&C.push(P)}}),C},$47l:function(G){var A=this,b=A.$13l,F=A.gv.dm();A.$10l?(A.fi({kind:"endEditRect",event:G,direction:A.$10l}),F.endTransaction()):A._shape&&b>=0?(A.fi({kind:"endEditPoint",event:G,data:A._shape,index:b}),F.endTransaction()):A._edge&&b>=0?(A.fi({kind:"endEditPoint",event:G,data:A._edge,index:b}),F.endTransaction()):A.$23l&&A.$40l&&(A.fi({kind:"endEditRotation",event:G}),F.endTransaction())},handleWindowTouchEnd:function(Y){this.handleWindowMouseUp(Y)},handleWindowMouseUp:function(m){var A=this,p=A.gv,_=p.dm(),O=A._shape,d=A._edge,l=A.$13l,k=A.$40l,t=A.$9l,g=A.$10l,f=A.$67l;if((O||d)&&l>=0&&t>=0){var r,F;if(O){var y=O.p(),T=O.getRotation();r=O.getPoints(),F=r.get(t),Tf(O,y,T,l,F,!1)}else if(r=uj(p.getDataUI(d),d.s("edge.points"),!0),F=r.get(t),0===l){var L=r.get(0);d.s("edge.source.offset.x",F.x-L.x),d.s("edge.source.offset.y",F.y-L.y)}else if(l===r.size()-1){var G=r.get(r.size()-1);d.s("edge.target.offset.x",F.x-G.x),d.s("edge.target.offset.y",F.y-G.y)}else"points"===d.s("edge.type")&&(r.set(l,F),d.s("edge.points",qh(r)))}A.$47l(m);var o=A.$73l;1===f?(_.beginTransaction(),o?p.sm().each(function(l){if(l.setHost&&p.isHelperEditable(l,"host")){l.setHost(o);
var I=A.$75l,$=A.$74l;I&&(l.s("attach.row.index",I.rowIndex),l.s("attach.column.index",I.columnIndex)),$&&(l.s("attach.index",$.attachIndex),l.s("attach.offset",$.attachOffset),l.s("attach.offset.relative",!1),l.s("attach.offset.opposite",!1))}}):p.sm().each(function(C){C.setHost&&p.isHelperEditable(C,"host")&&(C.setHost(Z),C.s("attach.row.index",N),C.s("attach.column.index",N),C.s("attach.index",N),C.s("attach.offset",N),C.s("attach.offset.relative",!1),C.s("attach.offset.opposite",!1))}),_.endTransaction()):2===f?(_.beginTransaction(),o?p.sm().each(function(g){g.setParent&&p.isHelperEditable(g,"parent")&&g.setParent(o)}):p.sm().each(function(H){H.setParent&&p.isHelperEditable(H,"parent")&&H.setParent(Z)}),_.endTransaction()):3===f?o&&(_.beginTransaction(),p.sm().each(function(f){if(p.isHelperEditable(f,"edge")&&f instanceof K&&o instanceof K){var D=new q.Edge;_.add(D),D.setSource(f),D.setTarget(o),A.onEdgeCreated&&A.onEdgeCreated(m,D)}}),_.endTransaction()):5===f||6===f?o&&(_.beginTransaction(),p.sm().each(function(R){R instanceof x&&o instanceof K&&(5===f&&p.isHelperEditable(R,"source")?R.setSource(o):6===f&&p.isHelperEditable(R,"source")&&R.setTarget(o))}),_.endTransaction()):(7===f||8===f||9===f)&&_.endTransaction(),(g||k)&&A.$43l(!0),c?(A.clear(),delete A.$64l,A._68I||A.$43l()):(A.handle_mousemove(m,!0),f&&!A._68I&&A.$43l())},handleWindowTouchMove:function(C){this.handleWindowMouseMove(C)},handleWindowMouseMove:function(K){this._78I(K)},handle_mousemove:function(O,G,w){if(!this._pause){if(!w){var I=c?Ai(O):O;this.$61l={clientX:I.clientX,clientY:I.clientY}}if(G===!0||!i()){var B=this,f=B.gv,D=!1,r=Z;B.clear(),f.sm().size()>0&&(r=f.lp(w?B.$61l:O),D=B._79I(O,r)),D&&(f._editing=1),B.$12l!==B.$65l&&(B.$65l=B.$12l,B.setCursor(B.$12l)),B.$40l!==B.$64l&&(B.$64l=B.$40l,B._68I||B.$43l()),B._hoverSegmentIndex!==B.$66l&&(B.$66l=B._hoverSegmentIndex,B._68I||B.$43l())}}},_78I:function(o){this.autoScroll(o);var g=this,k=g.gv,j=k.lp(o),N=k.getZoom(),W=g.$13l;if((g._shape||g._edge)&&W>=0){var i,p,F,n=g._shape,T=g._edge,O=g.$24l,X=k.getPointSnapSpacing(),e=function(k,n){return X==Z||isNaN(X)?{x:k,y:n}:{x:t(k/X)*X,y:t(n/X)*X}};if(n){i=n.getPoints();var R=n.p(),q=n.getRotation(),Y=0;p=Hh(R,j.x-R.x,j.y-R.y,-q),Tf(n,R,q,W,j,!0,O,e),g.fi({kind:"betweenEditPoint",event:o,data:n,index:W})}else if(T){i=uj(k.getDataUI(T),T.s("edge.points"),!0),j.x-=O.x,j.y-=O.y,p=j;var h,E,l=T.s("edge.offset"),v=i.size(),A=v>2;if(0===W){var u=i.get(0);l&&(u=Xj(u,i.get(1),-l,A),j=Xj(j,i.get(1),-l,A)),h=j.x-u.x,E=j.y-u.y,F=e(h,E),T.s("edge.source.offset.x",F.x),T.s("edge.source.offset.y",F.y)}else if(W===v-1){var B=i.get(v-1);l&&(B=Xj(B,i.get(v-2),-l,A),j=Xj(j,i.get(v-2),-l,A)),h=j.x-B.x,E=j.y-B.y,F=e(h,E),T.s("edge.target.offset.x",F.x),T.s("edge.target.offset.y",F.y)}else"points"===T.s("edge.type")&&(F=e(j.x,j.y),F.e=i.get(W).e,i.set(W,F),T.s("edge.points",qh(i)));g.fi({kind:"betweenEditPoint",event:o,data:T,index:W})}if(delete g.$9l,k.isSnapPoint(n)||k.isSnapPoint(T))for(Y=0;Y<i.size();Y++)if(Y!==W){var d=i.get(Y);if(P(d,p)<k.getEditPointSize()/N){g.$9l=Y;break}}}else if(g.$10l){var O=g.$24l;j.x-=O.x,j.y-=O.y;var y=k.sm().getSelection(),Q=g.$1l,m=g.$7l,f=g.$10l,S=g.$4l,$=g.$2l,M=k.getEditRectPadding()/N,c=2*M,H=k.getSnapSpacing(),V=H!=Z&&!isNaN(H),w=am($,j,f,m,2*M,k.getResizeMode(),V,!0),z=g.$6l;if(V){var a=w.width-c,b=w.height-c,J=t(a/H)*H,tl=t(b/H)*H,Pr=J-a,Im=tl-b;("west"===f||"northwest"===f||"southwest"===f)&&(Pr=-Pr),("north"===f||"northwest"===f||"northeast"===f)&&(Im=-Im),w=am($,j,f,m,2*M,k.getResizeMode(),V,!1,Pr,Im)}g.$8l=w,z.x=w.x+M,z.y=w.y+M,z.width=w.width-c,z.height=w.height-c;var uq=w.x+w.width/2,yl=w.y+w.height/2,yb=z.x,Vn=z.y,cr=z.width/S.width,nl=z.height/S.height;y.each(function(N){if(N instanceof K&&k.isEditable(N)&&k.isRectEditable(N)){var u=Q[N.getId()],x=g.$3l[N.getId()],R={x:u.x+u.width/2,y:u.y+u.height/2},U=0,X=0,E=f,H=180*_(m-N.getRotation())/D;"northeast"===f?H>=315||45>H?(U=u.width*cr+u.x,X=u.height*(1-nl)+u.y,E="northeast"):H>=45&&135>H?(U=u.width*(1-nl)+u.x,X=u.height*(1-cr)+u.y,E="northwest"):H>=135&&225>H?(U=u.width*(1-cr)+u.x,X=u.height*nl+u.y,E="southwest"):(U=u.width*nl+u.x,X=u.height*cr+u.y,E="southeast"):"north"===f?H>=315||45>H?(X=u.height*(1-nl)+u.y,E="north"):H>=45&&135>H?(U=u.width*(1-nl)+u.x,E="west"):H>=135&&225>H?(X=u.height*nl+u.y,E="south"):(U=u.width*nl+u.x,E="east"):"northwest"===f?H>=315||45>H?(U=u.width*(1-cr)+u.x,X=u.height*(1-nl)+u.y,E="northwest"):H>=45&&135>H?(U=u.width*(1-nl)+u.x,X=u.height*cr+u.y,E="southwest"):H>=135&&225>H?(U=u.width*cr+u.x,X=u.height*nl+u.y,E="southeast"):(U=u.width*nl+u.x,X=u.height*(1-cr)+u.y,E="northeast"):"west"===f?H>=315||45>H?(U=u.width*(1-cr)+u.x,E="west"):H>=45&&135>H?(X=u.height*cr+u.y,E="south"):H>=135&&225>H?(U=u.width*cr+u.x,E="east"):(X=u.height*(1-cr)+u.y,E="north"):"southwest"===f?H>=315||45>H?(U=u.width*(1-cr)+u.x,X=u.height*nl+u.y,E="southwest"):H>=45&&135>H?(U=u.width*nl+u.x,X=u.height*cr+u.y,E="southeast"):H>=135&&225>H?(U=u.width*cr+u.x,X=u.height*(1-nl)+u.y,E="northeast"):(U=u.width*(1-nl)+u.x,X=u.height*(1-cr)+u.y,E="northwest"):"east"===f?H>=315||45>H?(U=u.width*cr+u.x,E="east"):H>=45&&135>H?(X=u.height*(1-cr)+u.y,E="north"):H>=135&&225>H?(U=u.width*(1-cr)+u.x,E="west"):(X=u.height*cr+u.y,E="south"):"south"===f?H>=315||45>H?(X=u.height*nl+u.y,E="south"):H>=45&&135>H?(U=u.width*nl+u.x,E="east"):H>=135&&225>H?(X=u.height*(1-nl)+u.y,E="north"):(U=u.width*(1-nl)+u.x,E="west"):"southeast"===f&&(H>=315||45>H?(U=u.width*cr+u.x,X=u.height*nl+u.y,E="southeast"):H>=45&&135>H?(U=u.width*nl+u.x,X=u.height*(1-cr)+u.y,E="northeast"):H>=135&&225>H?(U=u.width*(1-cr)+u.x,X=u.height*(1-nl)+u.y,E="northwest"):(U=u.width*(1-nl)+u.x,X=u.height*cr+u.y,E="southwest"));var B=Hh(R,U-R.x,X-R.y,N.getRotation());_n(N,u,E,{x:B.x,y:B.y});var j=yb+z.width*x.x,L=Vn+z.height*x.y,o={x:j,y:L};o=Hh({x:uq,y:yl},o.x-uq,o.y-yl,m),N.p(o.x,o.y)}}),g.fi({kind:"betweenEditRect",event:o,direction:f})}else if(g.$23l&&g.$40l){var vi=g.$8l,uk=vi.width,Jg=vi.height,R={x:vi.x+uk/2,y:vi.y+Jg/2},O=g.$24l,Oo=g.$23l,Sf=Oo.x/N-R.x,zf=Oo.y/N-R.y,nc=I(Sf*Sf+zf*zf),vm=Math.asin(O.x/nc),ks=k.sm().getSelection(),eh=G+L(j.y-R.y,j.x-R.x)-vm,sj=k.getSnapAngle(),eh=t(eh/sj)*sj;0>eh&&(eh+=s);var bq=eh-g.$7l,Hr=[R.x,0,R.y];ks.each(function(t){if(k.isEditable(t)&&k.isRotationEditable(t)&&k.isVisible(t)){var n=wk(t.p3(),Hr),z=Ao();Dl(z,-bq),t.setRotation(t.getRotation()+bq),ej(n,z),t.p3(Hr[0]+n[0],Hr[1]+n[1],Hr[2]+n[2])}}),g.$7l=eh,g.fi({kind:"betweenEditRotation",event:o})}else if([1,2,3,5,6].indexOf(g.$67l)>=0)g.$72l=o,g.$78l||(g.$78l=1,r(function(){C.isDragging()&&g.$43l(),delete g.$78l},12));else if(7===g.$67l){if(g.$87l instanceof U){var n=g.$87l,qk=g.$88l,Kg=C.clone(n.getPoints().get(qk)),jc=j.y-Kg.y;Kg.e||(Kg.e=0),g.$92l||(g.$92l=Kg.e),Kg.e=g.$92l-jc,n.setPoint(qk,Kg)}else if(g.$87l instanceof x){var T=g.$87l,qk=g.$88l,i=uj(k.getDataUI(T),T.s("edge.points")),Kg=i.get(qk),jc=j.y-Kg.y;Kg.e||(Kg.e=0),g.$92l||(g.$92l=Kg.e),Kg.e=g.$92l-jc,i.set(qk,Kg),T.s("edge.points",qh(i))}}else if(8===g.$67l){var ks=k.sm().getSelection(),Qb=g.$93l;Qb||(Qb=g.$93l={}),ks.each(function(r){if(r.p3){var G=r.p3(),p=Qb[r.getId()];p==Z&&(p=Qb[r.getId()]=G[1]),r.p3([G[0],p-(j.y-g.$90l.y/N),G[2]])}})}else if(9===g.$67l){var ks=k.sm().getSelection(),hm=g.$94l;hm||(hm=g.$94l={}),ks.each(function(I){if(I.s3){var f=I.s3(),r=hm[I.getId()];r==Z&&(r=hm[I.getId()]=f[1]);var o=r-(j.y-g.$91l.y/N);0>o&&(o=.01),I.s3([f[0],o,f[2]])}})}},$79l:function(M,W){var c=this,R=c.gv,y=R.getZoom(),s=R.getEditHelperSize(),o=M.x/y,d=M.y/y,U=s/y,x=U/2;return b({x:o-x,y:d-x,width:U,height:U},W)?!0:void 0},getHelperCursor:function(){return"crosshair"},_79I:function(Q,D){for(var y=this,a=y.gv,z=a.getZoom(),i=a.getEditPointSize(),J=i/z,h=J/2,B=y.$46l(Q),c=0;c<B.length;c++){var G,L,u=B[c],f=a.getDataUI(u);if(f&&f._55O){var O=f._55O;if(O._43O&&u instanceof x){if(G=u.s("edge.points"),G=uj(f,G),L=u.s("edge.segments"),L&&L.size()||(L=Cd(G)),y.$42l(u,D,G._as,L,"edge"))return!0;if("points"===u.s("edge.type")&&y.$41l(u,D,G._as,L,"edge"))return}if(O._43O&&u instanceof U&&O.$15l&&O.$15l.length===u.getPoints().size()){if(G=O.$15l,L=u.getSegments(),L&&L.size()||(L=Cd(G)),y.$42l(u,D,G,L,"shape"))return!0;if(y.$41l(u,D,G,L,"shape"))return}}}if(y.$16l){var G,W=y.$16l,R=W[3].x-W[7].x,s=W[3].y-W[7].y,k=I(R*R+s*s),o=W[1].x-W[5].x,N=W[1].y-W[5].y,M=I(o*o+N*N),K={x:D.x*z,y:D.y*z};if(y._80I(K,0,W[0],"northwest",k,M)||y._80I(K,1,W[1],"north",k,M)||y._80I(K,2,W[2],"northeast",k,M)||y._80I(K,7,W[7],"west",k,M)||y._80I(K,3,W[3],"east",k,M)||y._80I(K,6,W[6],"southwest",k,M)||y._80I(K,5,W[5],"south",k,M)||y._80I(K,4,W[4],"southeast",k,M))return!0}if(y.$23l){var P=y.$23l,r=P.x/z,q=P.y/z;if(b({x:r-h,y:q-h,width:J,height:J},D))return y.$40l=1,y.$12l=y.getHelperCursor("rotation")||"crosshair",!0}return y.$68l&&y.$79l(y.$68l,D)?(y.$67l=1,y.$12l=y.getHelperCursor("host")||"crosshair",!0):y.$69l&&y.$79l(y.$69l,D)?(y.$67l=2,y.$12l=y.getHelperCursor("parent")||"crosshair",!0):y.$70l&&y.$79l(y.$70l,D)?(y.$67l=3,y.$12l=y.getHelperCursor("edge")||"crosshair",!0):y.$71l&&y.$79l(y.$71l,D)?(y.$67l=4,y.$12l=y.getHelperCursor("remove")||"crosshair",!0):y.$82l&&y.$79l(y.$82l,D)?(y.$67l=5,y.$12l=y.getHelperCursor("source")||"crosshair",!0):y.$83l&&y.$79l(y.$83l,D)?(y.$67l=6,y.$12l=y.getHelperCursor("target")||"crosshair",!0):y._pointElevationHelperPoint&&y.$79l(y._pointElevationHelperPoint,D)?(y.$67l=7,y.$12l=y.getHelperCursor("pointElevation")||"crosshair",!0):y.$90l&&y.$79l(y.$90l,D)?(y.$67l=8,y.$12l=y.getHelperCursor("elevation")||"crosshair",!0):y.$91l&&y.$79l(y.$91l,D)?(y.$67l=9,y.$12l=y.getHelperCursor("tall")||"crosshair",!0):!1},_80I:function(d,w,i,R,C,u){var Q=this,p=Q.gv,q=p.getEditPointSize(),m=q/2,H=p.sm(),J=p.isDirectionEditable;if(J&&1===H.size()){var Z=H.ld();if(J=J.bind(p),Z instanceof K){if(!J(Z,R))return!1;if("east"===R){if(J(Z,"northeast")&&J(Z,"southeast")&&2*q>=u)return!1}else if("west"===R){if(J(Z,"northwest")&&J(Z,"southwest")&&2*q>=u)return!1}else if("north"===R){if(J(Z,"northwest")&&J(Z,"northeast")&&2*q>=C)return!1}else if("south"===R&&J(Z,"southwest")&&J(Z,"southeast")&&2*q>=C)return!1}}else{if(2*q>=C&&("north"===R||"south"===R))return!1;if(2*q>=u&&("east"===R||"west"===R))return!1}if(b({x:i.x-m,y:i.y-m,width:q,height:q},d)){if(Q.$10l!==R){var f=180*Q.$7l/D,n="";f>=337.5||22.5>f?n="north":f>=22.5&&67.5>f?n="northeast":f>=67.5&&112.5>f?n="east":f>=112.5&&157.5>f?n="southeast":f>=157.5&&202.5>f?n="south":f>=202.5&&247.5>f?n="southwest":f>=247.5&&292.5>f?n="west":f>=292.5&&337.5>f&&(n="northwest");var l=Im.indexOf(n),n=Im[w-(1-l)+8];switch(n){case"northwest":Q.$12l="nwse-resize";break;case"northeast":Q.$12l="nesw-resize";break;case"southwest":Q.$12l="nesw-resize";break;case"southeast":Q.$12l="nwse-resize";break;case"north":Q.$12l="ns-resize";break;case"east":Q.$12l="ew-resize";break;case"south":Q.$12l="ns-resize";break;case"west":Q.$12l="ew-resize"}Q.$10l=R}return!0}return!1},$42l:function(G,h,B,p,I){var J,f=this,s=f.gv,F=s.getEditPointSize(),i=F/s.getZoom(),t=-1,u={x:h.x,y:h.y,width:0,height:0},A=function(N){"shape"===I?f._shape=G:f._edge=G,f._removePointIndex=N},Q=function(F){"shape"===I?f._shape=G:f._edge=G,f.$13l=F,f.$12l="crosshair"};for(l(u,i/2),t=B.length-1,J=p.size()-1;J>=0;J--){var n=p.get(J);if(1===n||2===n)t-=1;else if(3===n){var o=B[t-1];if(b(u,o))return Q(t-1),!0;t-=2}else if(4===n){var D=B[t-1],W=B[t-2];if(b(u,D))return Q(t-1),!0;if(b(u,W))return Q(t-2),!0;t-=3}}for(t=B.length-1,J=p.size()-1;J>=0;J--){var n=p.get(J),C=B[t];if(b(u,C))return A(t),Q(t),!0;1===n||2===n?t-=1:3===n?t-=2:4===n&&(t-=3)}return!1},$41l:function(p,w,K,V,t){var M=this,g=M.gv,B=-1,$=0,Q={x:w.x,y:w.y,width:0,height:0},J=function(U,h){M._hoverSegmentIndex=h,M._lp=w,"shape"===t?M._shape=p:M._edge=p};for(l(Q,g.getSegmentHoverWidth()/2/g.getZoom()),p instanceof U&&p.isClosePath()&&V.indexOf(5)<0&&(V=new E(V._as),V.add(5));$<V.size();$++){var d=V.get($);if(1===d){var I=K[B],r=K[B+1];if(I){var A=Ng(new kb(I.x,I.y),new kb(r.x,r.y),new kb(Q.x,Q.y),new kb(Q.x+Q.width,Q.y+Q.height));if(A.$62l===n&&A.points.length>0)return J(A,$),!0}B+=1}else if(2===d){var I=K[B],r=K[B+1],A=Ng(new kb(I.x,I.y),new kb(r.x,r.y),new kb(Q.x,Q.y),new kb(Q.x+Q.width,Q.y+Q.height));if(A.$62l===n&&A.points.length>0)return J(A,$),!0;B+=1}else if(3===d){var I=K[B],N=K[B+1],q=K[B+2],A=qs(new kb(I.x,I.y),new kb(N.x,N.y),new kb(q.x,q.y),new kb(Q.x,Q.y),new kb(Q.x+Q.width,Q.y+Q.height));if(A.$62l===n)return J(A,$),!0;B+=2}else if(4===d){var I=K[B],L=K[B+1],o=K[B+2],q=K[B+3],A=Po(new kb(I.x,I.y),new kb(L.x,L.y),new kb(o.x,o.y),new kb(q.x,q.y),new kb(Q.x,Q.y),new kb(Q.x+Q.width,Q.y+Q.height));if(A.$62l===n)return J(A,$),!0;B+=3}else if(5===d){var I=K[B],r=K[0];if(I){var A=Ng(new kb(I.x,I.y),new kb(r.x,r.y),new kb(Q.x,Q.y),new kb(Q.x+Q.width,Q.y+Q.height));if(A.$62l===n&&A.points.length>0)return J(A,$),!0}}}return!1},addShapePoint:function(k,o,e){var l=this,m=l.gv,I=m.dm();if(I.beginTransaction(),0===arguments.length&&(k=l._shape||l._edge,o=l._hoverSegmentIndex,e=l._lp),k instanceof U||k instanceof x){var r=ve(k,m.getDataUI(k),o);if(!isNaN(o)&&e&&!isNaN(r)){var t=e;if(k instanceof U){var B=k.p(),y=k.getRotation(),R=k.toSegments();R&&R.size()||(R=Cd(k.getPoints())),k.isClosePath()&&R.indexOf(5)<0&&(R=new E(R._as),R.add(5));var K=R.get(o),G="addPoint",v="removePointAt";if(2===K||1===K){var W={x:t.x,y:t.y};R.add(K,o),W=Hh(B,W.x-B.x,W.y-B.y,-y),k[G](W,r+1)}else if(3===K){var X=k.getPoints(),L=X.get(r),Y=X.get(r+2),W={x:t.x,y:t.y};W=Hh(B,W.x-B.x,W.y-B.y,-y);var q=Ie(L,W),M=Ie(W,Y);R.removeAt(o),R.add(3,o),R.add(3,o),k.setPoint(r+1,W),k[G](M,r+2),k[G](q,r+1)}else if(4===K){var X=k.getPoints(),L=X.get(r),Y=X.get(r+3),W={x:t.x,y:t.y};W=Hh(B,W.x-B.x,W.y-B.y,-y);var q=Cm(L,W),M=Di(L,W),u=Cm(W,Y),V=Di(W,Y);R.removeAt(o),R.add(4,o),R.add(4,o),k[v](r+1),k[v](r+1),k[G](W,r+1),k[G](V,r+2),k[G](u,r+2),k[G](M,r+1),k[G](q,r+1)}else if(5===K){var W={x:t.x,y:t.y};R.add(2,o),W=Hh(B,W.x-B.x,W.y-B.y,-y),k[G](W,r+1)}k.isClosePath()&&R.remove(5),k.setSegments(R);var T=k.getWidth(),h=k.getHeight(),g=k.p().x-T/2,c=k.p().y-h/2;g-=B.x,c-=B.y;var d=al(k,{x:g,y:c,width:T,height:h},y,B);k.p(d.x,d.y)}else if(k instanceof x){if("points"!==k.s("edge.type"))return I.endTransaction(),void 0;var X=k.s("edge.points");R=k.s("edge.segments"),X=uj(m.getDataUI(k),X),R&&R.size()||(R=Cd(X)),R=new E(R._as.slice(0)),X=new E(X._as.slice(0));var K=R.get(o);if(2===K||1===K){var W={x:t.x,y:t.y};R.add(K,o),X.add(W,r+1)}else if(3===K){var L=X.get(r),Y=X.get(r+2),W={x:t.x,y:t.y},q=Ie(L,W),M=Ie(W,Y);R.removeAt(o),R.add(3,o),R.add(3,o),X.set(r+1,W),X.add(M,r+2),X.add(q,r+1)}else if(4===K){var L=X.get(r),Y=X.get(r+3),W={x:t.x,y:t.y},q=Cm(L,W),M=Di(L,W),u=Cm(W,Y),V=Di(W,Y);R.removeAt(o),R.add(4,o),R.add(4,o),X.removeAt(r+1),X.removeAt(r+1),X.add(W,r+1),X.add(V,r+2),X.add(u,r+2),X.add(M,r+1),X.add(q,r+1)}k.s("edge.points",qh(X)),k.s("edge.segments",R)}}}I.endTransaction()},removeShapePoint:function(N,j){var s=this,d="removeAt",f=s.gv,q=f.dm();if(q.beginTransaction(),0===arguments.length&&(N=s._shape||s._edge,j=s._removePointIndex),j>=0&&(N instanceof U||N instanceof x)){var n=Wq(N,s.gv.getDataUI(N),j),m=j;if(N instanceof U){var G=N.p(),z=N.toSegments();z&&z.size()||(z=Cd(N.getPoints()));var K=z.get(n),p="removePointAt";if(1===K&&0===m)if(N.getPoints().size()>1){var w=z.get(n+1);z[d](n+1),3===w?N[p](m+1):4===w&&(N[p](m+2),N[p](m+1)),N[p](m)}else N.dm().remove(N);else 2===K||1===K?(z[d](n),N[p](m)):3===K?(z[d](n),N[p](m),N[p](m-1)):4===K&&(z[d](n),N[p](m),N[p](m-1),N[p](m-2));N.setSegments(z);var V=N.getWidth(),a=N.getHeight(),T=N.p().x-V/2,L=N.p().y-a/2;T-=G.x,L-=G.y;var P=al(N,{x:T,y:L,width:V,height:a},N.getRotation(),G);N.p(P.x,P.y)}else if(N instanceof x){if("points"!==N.s("edge.type"))return q.endTransaction(),void 0;var F=N.s("edge.points");if(z=N.s("edge.segments"),F&&(F=uj(s.gv.getDataUI(N),F),z&&z.size()||(z=Cd(F))),0===j||j===F.size()-1)return q.endTransaction(),void 0;z=new E(z._as.slice(0)),F=new E(F._as.slice(0));var K=z.get(n);2===K||1===K?(z[d](n),F[d](m)):3===K?(z[d](n),F[d](m),F[d](m-1)):4===K&&(z[d](n),F[d](m),F[d](m-1),F[d](m-2)),N.s("edge.segments",z),N.s("edge.points",qh(F))}}q.endTransaction()},changeShapeSegment:function(N,v,r){var j=this,s=j.gv,k=s.dm();if(k.beginTransaction(),1!==arguments.length||isNaN(N)||(r=N,N=j._shape||j._edge,v=j._hoverSegmentIndex),N instanceof U||N instanceof x){var e=ve(N,j.gv.getDataUI(N),v);if(!isNaN(v)&&!isNaN(e))if(N instanceof U){var W=N.p(),G=N.toSegments();G&&G.size()||(G=Cd(N.getPoints()));var f=G.get(v),Q=N.toPoints();if(1===r||2===r)1===f||2===f?G.set(v,r):3===f?(G.set(v,r),Q.removeAt(e+1)):4===f&&(G.set(v,r),Q.removeAt(e+1),Q.removeAt(e+1));else if(3===r){var z=function(){var h=Q.get(e),H=Q.get(e+1),$=Ie(h,H);G.set(v,3),Q.add($,e+1)};2===f||1===f?z():4===f&&(Q.removeAt(e+1),Q.removeAt(e+1),z())}else if(4===r){var c=function(){var n=Q.get(e),V=Q.get(e+1),J=Cm(n,V),o=Di(n,V);G.set(v,4),Q.add(J,e+1),Q.add(o,e+2)};2===f||1===f?c():3===f&&(Q.removeAt(e+1),c())}N.setSegments(G),N.setPoints(Q);var Z=N.getWidth(),b=N.getHeight(),t=N.p().x-Z/2,D=N.p().y-b/2;t-=W.x,D-=W.y;var C=new al(N,{x:t,y:D,width:Z,height:b},N.getRotation(),W);N.p(C.x,C.y)}else if(N instanceof x){if("points"!==N.s("edge.type"))return k.endTransaction(),void 0;var Q=N.s("edge.points");G=N.s("edge.segments"),Q&&(Q=uj(j.gv.getDataUI(N),Q),G&&G.size()||(G=Cd(Q))),G=new E(G._as.slice(0)),Q=new E(Q._as.slice(0));var f=G.get(v);if(1===r||2===r)1===f||2===f?G.set(v,r):3===f?(G.set(v,r),Q.removeAt(e+1)):4===f&&(G.set(v,r),Q.removeAt(e+1),Q.removeAt(e+1));else if(3===r){var z=function(){var M=Q.get(e),O=Q.get(e+1),I=Ie(M,O);G.set(v,3),Q.add(I,e+1)};2===f||1===f?z():4===f&&(Q.removeAt(e+1),Q.removeAt(e+1),z())}else if(4===r){var c=function(){var w=Q.get(e),D=Q.get(e+1),X=Cm(w,D),t=Di(w,D);G.set(v,4),Q.add(X,e+1),Q.add(t,e+2)};2===f||1===f?c():3===f&&(Q.removeAt(e+1),c())}N.s("edge.points",qh(Q)),N.s("edge.segments",G)}}k.endTransaction()},getDefaultSegments:function(f){var M=this.gv,I=M.getDataUI(f);if(f instanceof x){var e=f.s("edge.points");return e=uj(I,e),Cd(e)}if(f instanceof U){var e=f.getPoints(),$=f.getSegments();return $&&$.size()>0?$:Cd(e)}},$43l:function(i){var U=this;i&&(U.$5l=1),U._68I=1,U._42()},_42:function(){var _=this;if(_._68I){delete _._68I;var R=_.gv,M=_.$5l,X=R.getZoom(),i=R.getEditPointSize(),w=i/2,H=new E,k=_._view,y=_._edge,F=_._shape,h=k.getContext("2d"),T=R.tx(),j=R.ty(),m=Z,D=R.getEditPointBackground(),c=R.getControlPointBackground(),g=R.getControlPointBorderColor(),d=R.getEditPointBorderColor(),$=R.getEditRectBorderColor(),t=R.getDirectionLineColor(),e=R.getSegmentHoverColor(),u=R.getSnapPointBorderColor(),A=R.getJoinPointBackground(),N=R.getJoinPointBorderColor(),L=R.getSegmentHoverWidth(),O=[5,5],f=R.getEditRectBorderStyle();cl(R,function(w){R.isSelected(w)&&R.isVisible(w)&&H.add(w)}),h.clearRect(0,0,V(k.width),V(k.height)),h.save(),o.translateAndScale(h,T,j,1);var Y=Z,v={x:0,y:0,width:0,height:0},P=0,G=0,n=0,b=0,a=0,r=0,cq=0,hg=0,cd=0,ab=0,ki=[];if(M?(delete _.$6l,delete _.$8l,delete _.$7l,delete _.$16l,delete _.$23l):(Y=_.$6l,m=_.$7l),delete _.$68l,delete _.$69l,delete _.$71l,delete _.$70l,delete _.$82l,delete _.$83l,delete _._pointElevationHelperPoint,delete _.$90l,delete _.$91l,delete _.$75l,delete _.$74l,H.each(function(y){var i=R.getDataUI(y);if(i){var I=i._55O;if(R.isEditable(y))I._56O&&y instanceof K&&G++,ki.push(y),I._42O&&y instanceof K&&P++,R.isHelperEditable(y,"host")&&b++,R.isHelperEditable(y,"parent")&&n++,R.isHelperEditable(y,"remove")&&a++,R.isHelperEditable(y,"edge")&&r++,R.isHelperEditable(y,"source")&&cq++,R.isHelperEditable(y,"target")&&hg++,R.isHelperEditable(y,"elevation")&&cd++,R.isHelperEditable(y,"tall")&&ab++;else if(y instanceof z&&y.isExpanded()){var W=!0,H=R.getEditableFunc();H&&(W=H(y)),W&&(R.isHelperEditable(y,"host")&&b++,R.isHelperEditable(y,"parent")&&n++,R.isHelperEditable(y,"remove")&&a++,R.isHelperEditable(y,"edge")&&r++,R.isHelperEditable(y,"source")&&cq++,R.isHelperEditable(y,"target")&&hg++,R.isHelperEditable(y,"elevation")&&cd++,R.isHelperEditable(y,"tall")&&ab++,ki.push(y))}}}),h.beginPath(),h.lineWidth=1,h.strokeStyle=R.getNodeBorderColor(),ki.forEach(function(V){var g=R.getDataUI(V),b=g._55O;if(M)if(m==Z&&(m=V instanceof x?0:V instanceof z&&V.isExpanded()?0:V.getRotation(),_.$7l=m),Y==Z){var C,k,$;if(V instanceof z&&V.isExpanded()||V instanceof x){var c=R.getDataUIBounds(V);k=c.width,$=c.height,C={x:c.x+k/2,y:c.y+$/2}}else C=V.p(),k=V.getWidth(),$=V.getHeight();Y={x:C.x,y:C.y,width:0,height:0},v.x=C.x-k/2,v.y=C.y-$/2,v.width=k,v.height=$,Y=Q(Y,v)}else{var C,k,$,y,T=Y.x+Y.width/2,W=Y.y+Y.height/2,N={x:T,y:W};if(V instanceof z&&V.isExpanded()||V instanceof x){y=0;var c=R.getDataUIBounds(V);k=c.width,$=c.height,C={x:c.x+k/2,y:c.y+$/2}}else C=V.p(),k=V.getWidth(),$=V.getHeight(),y=V.getRotation();var t={x:C.x-k/2,y:C.y-$/2,width:k,height:$},A={x:t.x,y:t.y},J={x:t.x+t.width,y:t.y},F={x:t.x,y:t.y+t.height},e={x:t.x+t.width,y:t.y+t.height},A=Hh(C,A.x-C.x,A.y-C.y,y),F=Hh(C,F.x-C.x,F.y-C.y,y),e=Hh(C,e.x-C.x,e.y-C.y,y),J=Hh(C,J.x-C.x,J.y-C.y,y),s=-m,d=Hh(N,A.x-N.x,A.y-N.y,s),j=Hh(N,J.x-N.x,J.y-N.y,s),l=Hh(N,F.x-N.x,F.y-N.y,s),q=Hh(N,e.x-N.x,e.y-N.y,s),S=p([d,j,l,q]);Y=Q(Y,S),Y.x-=T,Y.y-=W;var L=al(Z,Y,m,N);Y.x=L.x-Y.width/2,Y.y=L.y-Y.height/2}if(P>1&&R.isEditable(V)&&R.isRectEditable(V)&&V instanceof K){var H=V.getRect(),f=b.$45l,O=Rm(f[0],X),i=Rm(f[2],X),r=Rm(f[4],X),U=Rm(f[6],X);V.getRotation()?(h.moveTo(O.x,O.y),h.lineTo(i.x,i.y),h.lineTo(r.x,r.y),h.lineTo(U.x,U.y),h.lineTo(O.x,O.y)):h.rect(H.x*X,H.y*X,H.width*X,H.height*X)}}),h.stroke(),Y){_.$6l=B(Y),l(Y,R.getEditRectPadding()/X);var Ce={x:Y.x+Y.width/2,y:Y.y+Y.height/2},zo=je(Ce,Y.width,Y.height,m),Yh=zo[0],Pj=zo[1],Ci=zo[2],xp=zo[3],Sp=zo[4],Qg=zo[5],Pr=zo[6],$d=zo[7];if(Yh=Rm(zo[0],X),Pj=Rm(zo[1],X),Ci=Rm(zo[2],X),xp=Rm(zo[3],X),Sp=Rm(zo[4],X),Qg=Rm(zo[5],X),Pr=Rm(zo[6],X),$d=Rm(zo[7],X),_.$8l=Y,P>0&&(_.$16l=[Yh,Sp,Pj,Qg,xp,Pr,Ci,$d],h.beginPath(),h.lineWidth=1,h.strokeStyle=$,"dashed"===f&&h.setLineDash&&h.setLineDash(O),h.moveTo(Yh.x,Yh.y),h.lineTo(Pj.x,Pj.y),h.lineTo(xp.x,xp.y),h.lineTo(Ci.x,Ci.y),h.lineTo(Yh.x,Yh.y),h.stroke(),"dashed"===f&&h.setLineDash&&h.setLineDash([])),h.beginPath(),h.lineWidth=1,h.fillStyle=D,h.strokeStyle=d,P>0){var hp=Qg.x-$d.x,sl=Qg.y-$d.y,he=I(hp*hp+sl*sl),fh=Sp.x-Pr.x,re=Sp.y-Pr.y,Yr=I(fh*fh+re*re),qn=2*i;if(R.isDirectionEditable&&1===ki.length){var or=ki[0],mq=R.getDataUI(or),Bo=mq._55O,Uf=R.isDirectionEditable.bind(R);if(Bo._42O){var no,Wc,Ee,Li;Uf(or,"northwest")&&(no=!0,h.rect(Yh.x-w,Yh.y-w,i,i)),Uf(or,"northeast")&&(Wc=!0,h.rect(Pj.x-w,Pj.y-w,i,i)),Uf(or,"southwest")&&(Ee=!0,h.rect(Ci.x-w,Ci.y-w,i,i)),Uf(or,"southeast")&&(Li=!0,h.rect(xp.x-w,xp.y-w,i,i)),Uf(or,"north")&&(no&&Wc?he>qn&&h.rect(Sp.x-w,Sp.y-w,i,i):h.rect(Sp.x-w,Sp.y-w,i,i)),Uf(or,"south")&&(Li&&Ee?he>qn&&h.rect(Pr.x-w,Pr.y-w,i,i):h.rect(Pr.x-w,Pr.y-w,i,i)),Uf(or,"west")&&(Ee&&no?Yr>qn&&h.rect($d.x-w,$d.y-w,i,i):h.rect($d.x-w,$d.y-w,i,i)),Uf(or,"east")&&(Li&&Wc?Yr>qn&&h.rect(Qg.x-w,Qg.y-w,i,i):h.rect(Qg.x-w,Qg.y-w,i,i))}}else he>qn&&(h.rect(Sp.x-w,Sp.y-w,i,i),h.rect(Pr.x-w,Pr.y-w,i,i)),Yr>qn&&(h.rect(Qg.x-w,Qg.y-w,i,i),h.rect($d.x-w,$d.y-w,i,i)),h.rect(Yh.x-w,Yh.y-w,i,i),h.rect(Pj.x-w,Pj.y-w,i,i),h.rect(Ci.x-w,Ci.y-w,i,i),h.rect(xp.x-w,xp.y-w,i,i)}if(G>0){var Qk=_.$23l=Hh(Sp,0,2*-i,m);h.moveTo(Qk.x+w,Qk.y),h.arc(Qk.x,Qk.y,w,0,s,!1)}h.fill(),h.stroke(),_.$40l&&_.$44l(h,Y,m);var yd,Uo,vb=R.getLeftTopHelpers(),vd=R.getRightTopHelpers(),xk=R.getLeftBottomHelpers(),Yc=R.getRightBottomHelpers(),Wi=R.getEdgeHelpers(),kg=R.getEditHelperSize(),Zc=kg/2,Cf=function(k,D,J,I){"leftTop"===D?(yd=Y.x*X-kg-w-("h"===I?J*(kg+w):0)-1,Uo=Y.y*X-kg-w-("v"===I?J*(kg+w):0)-1):"rightTop"===D?(yd=(Y.x+Y.width)*X+w+("h"===I?J*(kg+w):0)+1,Uo=Y.y*X-kg-w-("v"===I?J*(kg+w):0)-1):"leftBottom"===D?(yd=Y.x*X-kg-w-("h"===I?J*(kg+w):0)-1,Uo=(Y.y+Y.height)*X+w+("v"===I?J*(kg+w):0)+1):"rightBottom"===D&&(yd=(Y.x+Y.width)*X+w+("h"===I?J*(kg+w):0)+1,Uo=(Y.y+Y.height)*X+w+("v"===I?J*(kg+w):0)+1);var H=yd+Zc,e=Uo+Zc,G=(Y.x+Y.width/2)*X,l=(Y.y+Y.height/2)*X,O=Hh({x:G,y:l},H-G,e-l,m);if("host"===k){if(b>0)return _.$77l(h,m,O),!0}else if("edge"===k){if(r>0)return _.$80l(h,m,O),!0}else if("remove"===k){if(a>0)return ki&&1===ki.length&&ki[0]instanceof x?_.$81l(h,m,{x:G+kg/2+5,y:l}):_.$81l(h,m,O),!0}else if("parent"===k){if(n>0)return ki&&1===ki.length&&ki[0]instanceof x?_.$76l(h,m,{x:G-kg/2-5,y:l}):_.$76l(h,m,O),!0}else if("elevation"===k){if(cd>0)return _.$85l(h,m,O),!0}else if("tall"===k){if(ab>0)return _.$86l(h,m,O),!0}else if("source"===k||"target"===k){var A=ki[0],q=R.getDataUI(A),d=gd(q,!0),g=d[0],L=d[1];if(cq&&"source"===k)return _.$84l(h,Y,g,!0,A.isLooped(),D,J,I),!0;if(hg&&"target"===k)return _.$84l(h,Y,L,!1,A.isLooped(),D,J,I),!0}};if(vb&&vb.length>0){var Ii=0;vb.forEach(function(b){Cf(b,"leftTop",Ii,R.getLeftTopHelpersAlign()||"h")&&Ii++})}if(vd&&vd.length>0){var Ii=0;vd.forEach(function(p){Cf(p,"rightTop",Ii,R.getRightTopHelpersAlign()||"h")&&Ii++})}if(xk&&xk.length>0){var Ii=0;xk.forEach(function(C){Cf(C,"leftBottom",Ii,R.getLeftBottomHelpersAlign()||"h")&&Ii++})}if(Yc&&Yc.length>0){var Ii=0;Yc.forEach(function(S){Cf(S,"rightBottom",Ii,R.getRightBottomHelpersAlign()||"h")&&Ii++})}if(Wi&&Wi.length>0&&((cq||hg)&&ki&&1===ki.length&&ki[0]instanceof x?!0:!1)){var Ii=0;Wi.forEach(function(M){Cf(M,"edge",Ii,"h")&&Ii++})}if(_.$72l){var gj,Ko=_.$67l,Wq=_.$68l,ib=_.$69l,uc=(_.$71l,_.$70l),Lq=_.$82l,An=_.$83l;if(1===Ko?gj=Wq:2===Ko?gj=ib:3===Ko?gj=uc:5===Ko?gj=Lq:6===Ko&&(gj=An),gj){var Id=R.lp(_.$72l),Yo=R.getDataAt(_.$72l);if(Yo&&Yo instanceof K){var sm,Pl,Ch;if(_.$73l=Yo,1===Ko)if(Yo instanceof q.Grid)sm=_.$75l=Cn(Yo,Id);else if(Yo instanceof q.Shape){Ch=_.$74l=ul(Yo,Id);var lm=Yo.getPoints();if(Ch){var Zn=Ch.attachIndex,Zm=ve(Yo,R.getDataUI(Yo),Zn)+1,_g=Zm+1>=lm.size()?0:Zm+1,tn=lm.get(Zm),Ur=lm.get(_g),hf=Yo.p(),qs=Yo.getRotation();tn=Hh(hf,tn.x-hf.x,tn.y-hf.y,qs),Ur=Hh(hf,Ur.x-hf.x,Ur.y-hf.y,qs),h.beginPath(),h.strokeStyle=e,h.lineWidth=L,h.moveTo(tn.x*X,tn.y*X),h.lineTo(Ur.x*X,Ur.y*X),h.stroke()}}sm?Pl=sm.rect:(Pl=C.clone(R.getDataUIBounds(Yo)),C.grow(Pl,2)),h.beginPath(),h.rect(Pl.x*X,Pl.y*X,Pl.width*X,Pl.height*X),h.strokeStyle=1===Ko||4===Ko||6===Ko?W:S,h.lineWidth=2,h.setLineDash&&h.setLineDash([8,8]),h.stroke()}else delete _.$73l;Id.x=Id.x*X,Id.y=Id.y*X;var _n=od(gj.x,gj.y,Id.x,Id.y),pg=Hh(gj,Id.x-gj.x,Id.y-gj.y,-_n),$r=pg.x-gj.x;h.save(),h.translate(gj.x,gj.y),h.rotate(_n),J.width=$r,J.height=40;var Nf=S;(1===Ko||4===Ko||6===Ko)&&(Nf=W),J.comps[0].gradientColor=Nf,C.drawImage(h,J,0,-20,$r,40),h.restore()}}}if(H.each(function(f){var x=R.getDataUI(f);if(x){var V,m,r=x._55O,a=x._78o;if(r&&r._43O&&f instanceof U?(V=r.$15l,m=f.getSegments(),m&&m.size()||(m=Cd(V)),f.isClosePath()&&m.indexOf(5)<0&&(m=new E(m._as),m.add(5))):r&&a&&r._43O&&(V=f.s("edge.points"),m=f.s("edge.segments"),V=uj(x,V),m&&m.size()||(m=Cd(V)),V&&(V=V._as)),V&&m){var z=0,j=m.size(),D=_._hoverSegmentIndex;V=V.slice(0);for(var d=0;d<V.length;d++)V[d]=Rm(V[d],X);h.beginPath(),h.strokeStyle=t,h.lineWidth=1,z=0;for(var d=0;j>d;d++){var M=m.get(d);if(1===M||2===M)z++;else if(3===M){var b=V[z-1],Y=V[z],n=V[z+1];h.moveTo(b.x,b.y),h.lineTo(Y.x,Y.y),h.lineTo(n.x,n.y),z+=2}else if(4===M){var b=V[z-1],K=V[z],v=V[z+1],n=V[z+2];h.moveTo(b.x,b.y),h.lineTo(K.x,K.y),h.moveTo(v.x,v.y),h.lineTo(n.x,n.y),z+=3}}if(h.stroke(),F===f||y===f&&"points"===y.s("edge.type")){h.beginPath(),z=0,h.strokeStyle=e,h.lineWidth=L;for(var d=0;j>d;d++){var M=m.get(d);if(1===M||2===M){if(D===d){var b=V[z-1],n=V[z];h.moveTo(b.x,b.y),h.lineTo(n.x,n.y);break}z++}else if(3===M){if(D===d){var b=V[z-1],Y=V[z],n=V[z+1];h.moveTo(b.x,b.y),h.quadraticCurveTo(Y.x,Y.y,n.x,n.y);break}z+=2}else if(4===M){if(D===d){var b=V[z-1],K=V[z],v=V[z+1],n=V[z+2];h.moveTo(b.x,b.y),h.bezierCurveTo(K.x,K.y,v.x,v.y,n.x,n.y);break}z+=3}else if(5===M&&D===d){var b=V[z-1],n=V[0];h.moveTo(b.x,b.y),h.lineTo(n.x,n.y);break}}h.stroke()}h.beginPath(),z=0,h.strokeStyle=N,h.lineWidth=1,h.fillStyle=A;for(var d=0;j>d;d++){var M=m.get(d);if(1===M||2===M){var n=V[z];h.moveTo(n.x+w,n.y),h.arc(n.x,n.y,w,0,s,!0),z++}else if(3===M){var n=V[z+1];h.moveTo(n.x+w,n.y),h.arc(n.x,n.y,w,0,s,!0),z+=2}else if(4===M){var n=V[z+2];h.moveTo(n.x+w,n.y),h.arc(n.x,n.y,w,0,s,!0),z+=3}}h.fill(),h.stroke(),h.beginPath(),z=0,h.strokeStyle=g,h.lineWidth=1,h.fillStyle=c;for(var d=0;j>d;d++){var M=m.get(d);if(1===M||2===M)z++;else if(3===M){var Y=V[z];h.moveTo(Y.x+w,Y.y),h.arc(Y.x,Y.y,w,0,s,!0),z+=2}else if(4===M){var K=V[z],v=V[z+1];h.moveTo(K.x+w,K.y),h.arc(K.x,K.y,w,0,s,!0),h.moveTo(v.x+w,v.y),h.arc(v.x,v.y,w,0,s,!0),z+=3}}if(h.fill(),h.stroke(),h.beginPath(),z=0,h.strokeStyle=u,h.lineWidth=2,(F===f||y===f)&&_.$9l!=Z){var n=V[_.$9l];h.moveTo(n.x+w,n.y),h.arc(n.x,n.y,w,0,s,!0),h.stroke()}}}}),_.$87l&&R.sm().contains(_.$87l)){var hr,Xo=_.$87l,wh=_.$88l,kg=R.getEditHelperSize(),Zc=kg/2;if(R.isHelperEditable(Xo,"pointElevation"))if(Xo instanceof U){var bi=Xo.getPosition();hr=C.clone(Xo.getPoints().get(wh)),hr=Hh({x:bi.x,y:bi.y},hr.x-bi.x,hr.y-bi.y,Xo.getRotation()),hr.x*=X,hr.y*=X,h.translate(hr.x,hr.y),C.drawImage(h,C.getImage("xeditinteractor_elevationIcon"),Zc,-Zc,kg,kg),h.translate(-hr.x,-hr.y),_._pointElevationHelperPoint={x:hr.x+kg,y:hr.y}}else if(Xo instanceof x){var dk=uj(R.getDataUI(Xo),Xo.s("edge.points")),hr=C.clone(dk.get(wh));hr.x*=X,hr.y*=X,h.translate(hr.x,hr.y),C.drawImage(h,C.getImage("xeditinteractor_elevationIcon"),Zc,-Zc,kg,kg),h.translate(-hr.x,-hr.y),_._pointElevationHelperPoint={x:hr.x+kg,y:hr.y}}}h.restore(),_.$5l=0}},$89l:function(B,L,y,z){B.save();var w=this,I=w.gv,b=I.getEditHelperSize(),d=b/2;B.beginPath(),B.translate(y.x,y.y),B.rotate(L),C.drawImage(B,z,-d,-d,b,b),B.restore()},$85l:function(V,W,H){var T=this;T.$90l=H,T.$89l(V,W,H,C.getImage("xeditinteractor_elevationIcon"))},$86l:function(T,Y,U){var P=this;P.$91l=U,P.$89l(T,Y,U,C.getImage("xeditinteractor_tallIcon"))},$77l:function(j,O,L){var t=this;t.$68l=L,t.$89l(j,O,L,C.getImage("xeditinteractor_hostIcon"))},$80l:function(Z,l,i){var Y=this;Y.$70l=i,Y.$89l(Z,l,i,C.getImage("xeditinteractor_edgeIcon"))},$81l:function(x,i,Z){var Q=this;Q.$71l=Z,Q.$89l(x,i,Z,C.getImage("xeditinteractor_removeIcon"))},$76l:function(d,l,q){var y=this;y.$69l=q,y.$89l(d,l,q,C.getImage("xeditinteractor_parentIcon"))},$84l:function(U,T,o,_,h){var S,P=this,m=P.gv,W=m.getZoom(),X=m.getEditHelperSize(),E=X/2;o.x*=W,o.y*=W,h&&(_?o.x-=E+5:o.x+=E+5),o.y-=X-2,_?(P.$82l=o,S=C.getImage("xeditinteractor_sourceIcon")):(P.$83l=o,S=C.getImage("xeditinteractor_targetIcon")),U.beginPath(),U.translate(o.x,o.y),C.drawImage(U,S,-E,-E,X,X),U.translate(-o.x,-o.y)},$44l:function(r,o,T){r.save();var U=this.gv.getZoom(),j=I($(o.width,2)+$(o.height,2))/2*U+10,k=j,N=k+8,Q=k+18,v=T,V=o.x+o.width/2,E=o.y+o.height/2;r.translate(V*U,E*U),r.beginPath(),r.strokeStyle="rgb(150, 150, 150)";for(var b=0,A=0,O=0,M=0,i=0,u=0;360>u;u++)b=u*D/180,0===u%5&&(A=X(b)*k,O=Y(b)*k,M=X(b)*N,i=Y(b)*N,r.moveTo(A,O),r.lineTo(M,i)),0===u%45&&(A=X(b)*k,O=Y(b)*k,M=X(b)*Q,i=Y(b)*Q,r.moveTo(A,O),r.lineTo(M,i));r.stroke(),r.beginPath(),r.rotate(-G),r.beginPath(),r.fillStyle="rgba(255, 0, 0, 0.1)",r.strokeStyle="rgb(157, 157, 157)",r.moveTo(0,0),r.arc(0,0,Q,0,T,!1),r.fill(),r.beginPath(),r.moveTo(0+Q,0),r.arc(0,0,Q,0,T,!1),r.stroke(),r.rotate(G),r.font="bold 12px Verdana, Arial";var d=20*Y(v),H=20*X(v),P=t(180*v/D)+"°";r.textAlign="center",r.textBaseline="middle",r.beginPath();var x=r.measureText("365.°").width;r.fillStyle="white",r.rect(d-x/2,-H-10,x,20),r.fill(),r.beginPath(),r.fillStyle="rgb(79,79,79)",r.fillText(P,d,-H),r.restore()}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);