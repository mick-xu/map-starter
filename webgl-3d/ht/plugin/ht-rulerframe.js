!function(Q,h){"use strict";var D="position",f="absolute",Z="relative",v="px",Y="left",N="right",w="top",K="bottom",F="display",L="none",U="block",O=ht.Default,P=O.getInternal(),p=Math.floor,b=Math.ceil,g=Math.PI,d=null,B=Q.parseInt,G=function(K){return K.getContext("2d")},o=function(){return document},E=function(V){return o().createElement(V)},T=function(){return E("canvas")},l=function(W,c,v){W.style.setProperty(c,v,d)},a=function(t,x,m){O.def(ht.widget[t],x,m)},S=function(p,V){p.appendChild(V)},n=function(s,q){s.removeChild(q)},P=O.getInternal(),I=P.addEventListener,$=P.removeEventListener;ht.widget.RulerFrame=function(p){var h=this,t=h._view=P.createView(null,h),W=h.$1k=T(),O=h.$2k=T(),Q=h.$3k=T(),K=h.$4k=T();h._defaultRulerConfig={size:20,borderWidth:1,borderStyle:"solid",borderColor:"#888",defaultMajorTickSpacing:50,minMajorTickSpacing:10,minPhysicalMajorTickSpacing:40,maxPhysicalMajorTickSpacing:100,tickSpacingAdaptable:!0,majorTickTextFont:"12px Arial",majorTickTextColor:"#666",majorTickColor:"#888",minorTickColor:"#ccc",background:"rgba(0,0,0,0)",guideColor:"rgb(0, 173, 239)",guideWidth:2,guideVisible:!1,guideTipVisible:!1,guideTipBorderColor:"#666",guideTipTextColor:"#666",guideTipTextFont:"12px Arial",guideTipBackground:"#fff"},h._topRulerConfig={visible:!0},h._rightRulerConfig={visible:!1},h._bottomRulerConfig={visible:!1},h._leftRulerConfig={visible:!0},S(t,W),S(t,Q),S(t,O),S(t,K),l(t,D,Z),l(t,"box-sizing","border-box"),l(t,"-moz-box-sizing","border-box"),l(W,D,f),l(O,D,f),l(Q,D,f),l(K,D,f),h.$14k=function(){h.$13k=1,h.iv()},h.$15k=function(C){if(h._topRulerConfig.guideVisible||h._rightRulerConfig.guideVisible||h._bottomRulerConfig.guideVisible||h._leftRulerConfig.guideVisible||h._defaultRulerConfig.guideVisible||(h._topRulerConfig.guideTipVisible||h._rightRulerConfig.guideTipVisible||h._bottomRulerConfig.guideTipVisible||h._leftRulerConfig.guideTipVisible||h._defaultRulerConfig.guideTipVisible)&&h._component){var Y=t.getBoundingClientRect();h.$16k={x:C.clientX-Y.left,y:C.clientY-Y.top},h.$5k()}},h.setComponent(p)},a("RulerFrame",h,{ms_v:1,ms_fire:1,ms_ac:["defaultRulerConfig","topRulerConfig","rightRulerConfig","bottomRulerConfig","leftRulerConfig","component"],setComponent:function(h){var O=this,k=O._component,d=O.getView();if(d){if(O._component=h,O.fp("component",k,h),k){var m=O.getComponentView(k);n(d,m),$(d,"mousemove",O.$15k),O.removeComponentPropertyChangeListener(k,O.$14k)}if(h){var t=O.getComponentView(h);S(d,t),l(t,D,f),I(d,"mousemove",O.$15k),O.addComponentPropertyChangeListener(h,O.$14k)}}},addComponentPropertyChangeListener:function(r,P){r&&r.mp&&r.mp(P)},removeComponentPropertyChangeListener:function(r,b){r&&r.ump&&r.ump(b)},getComponentHZoom:function(l){return l&&l.getZoom?l.getZoom():1},getComponentVZoom:function(k){return k&&k.getZoom?k.getZoom():1},getComponentViewRect:function(J){return J&&J.getViewRect?J.getViewRect():void 0},getComponentView:function(o){return o&&o.getView?o.getView():o},invalidateComponent:function(f){f&&f.iv&&f.iv()},validateComponent:function(Q){Q&&Q.validate&&Q.validate()},$7k:function(w,g,J,f,h,t,c,X,W,I,B,v){if(g.visible){var R=this._defaultRulerConfig,C="borderStyle",q="borderColor",x="borderWidth",E="background",s=g[C]||R[C],e=g[q]||R[q],T=g[x]||R[x],O=g.size!=d?g.size:R.size,y=g[E]||R[E],N=O+T,S=this.$6k(T,s,e,w,J,h,N,c,X,W,I,B,v);l(w,h,"0px"),t?P.setCanvas(w,f-S,O):P.setCanvas(w,O,f-S),l(w,"background",y),l(w,F,U)}else l(w,F,L),l(this.getComponentView(this._component),h,"0px")},$6k:function(M,T,P,f,$,N,O,S,j,p,t,y,s){var A=0;return l(f,$,M+"px "+T+" "+P),l(this.getComponentView(this._component),N,O+v),S?(l(f,j,p+v),A+=p):l(f,j,"0px"),t?(l(f,y,s+v),A+=s):l(f,y,"0px"),A},validateImpl:function(){var g=this,I=g._component,O=g.$1k,H=g.$2k,V=g.$3k,Q=g.$4k,b=g._view,T=g._defaultRulerConfig,E=g._topRulerConfig,M=g._rightRulerConfig,m=g._bottomRulerConfig,t=g._leftRulerConfig,P=T.size;if(b&&I){var l=E.size!=d?E.size:P,i=M.size!=d?M.size:P,F=m.size!=d?m.size:P,h=t.size!=d?t.size:P;g.$7k(O,E,"border-bottom",b.offsetWidth,w,!0,t.visible,Y,h,M.visible,N,i),g.$7k(H,M,"border-left",b.offsetHeight,N,!1,E.visible,w,l,m.visible,K,F),g.$7k(V,m,"border-top",b.offsetWidth,K,!0,t.visible,Y,h,M.visible,N,i),g.$7k(Q,t,"border-right",b.offsetHeight,Y,!1,E.visible,w,l,m.visible,K,F),g.$13k?delete g.$13k:g.invalidateComponent(I),g.validateComponent(I),g.$5k()}},$5k:function(){function t(i,D,F,S,R,n){if(D.visible){var X=G(i),B=D[j]||M,h=D[s]!=d?D[s]:C,E=D[q]||W,U=D[x]||I,t=D.size!=d?D.size:K,Di=D[Z]||A,hc=D[H]||l,zc=D[a]||_,Bn=D[O]!=d?D[O]:f,Df=D[P]!=d?D[P]:r,Fg=D[N]!=d?D[N]:o,Zl=D[L]!=d?D[L]:g,dq=D[$]!=d?D[$]:Y,fk=D[w]!=d?D[w]:c,hd=D[e]||ae,Ur=D[z]||Ag;h&&(B=m[n]=m.$8k(m[n]||B,D[b]||k,D[p]||T,S?u:V,hc)),F.call(m,X,Q,y,v,J,t,S?u:V,B,E,U,R,Di,zc);var Rj=m.$16k;(Bn||Df)&&Rj&&(S?m.$9k(X,Rj.x,t,hd,Ur,Bn,Df,Fg,Zl,dq,fk):m.$10k(X,Rj.y,t,hd,Ur,Bn,Df,Fg,Zl,dq,fk,R))}}var m=this,R=m.$1k,E=m.$2k,U=m.$3k,i=m.$4k,F=m._topRulerConfig,S=m._rightRulerConfig,h=m._bottomRulerConfig,B=m._leftRulerConfig,X=m._defaultRulerConfig,n=m._component,D=m.getComponentViewRect(n),u=m.getComponentHZoom(n),V=m.getComponentVZoom(n),Q=D.x*u,v=Q+D.width*u,y=D.y*V,J=y+D.height*V,K=m._defaultRulerConfig.size,j="defaultMajorTickSpacing",b="maxPhysicalMajorTickSpacing",p="minPhysicalMajorTickSpacing",s="tickSpacingAdaptable",q="majorTickTextFont",x="majorTickTextColor",Z="majorTickColor",a="minorTickColor",O="guideVisible",P="guideTipVisible",N="guideTipBorderColor",L="guideTipTextColor",$="guideTipTextFont",w="guideTipBackground",e="guideColor",z="guideWidth",H="minMajorTickSpacing",M=X[j],k=X[b],T=X[p],C=X[s],W=X[q],I=X[x],A=X[Z],l=X[H],_=X[a],f=X[O],r=X[P],o=X[N],g=X[L],Y=X[$],c=X[w],ae=X[e],Ag=X[z];m._view&&n&&(t(R,F,m.$11k,!0,!1,"_currentTopMajorTickSpacing"),t(E,S,m.$12k,!1,!0,"_currentRightMajorTickSpacing"),t(U,h,m.$11k,!0,!0,"_currentBottomMajorTickSpacing"),t(i,B,m.$12k,!1,!1,"_currenLeftMajorTickSpacing"))},$8k:function(n,V,U,y,S){return U>n*y?n=p(V/y/S)*S:n*y>V&&(n=b(U/y/S)*S),n},getHTipText:function(E){var A=this,D=A._component,j=0,y=A._view.getBoundingClientRect();return D.lp?j=B(D.lp({x:E.x+y.left,y:E.y}).x):j-=B(this.getComponentView(D).style.left)||0,j},$9k:function(y,A,O,C,l,o,s,G,x,Q,R){var X=this,k=X._component;y.save(),P.translateAndScale(y,0,0,1);var H=A-(B(this.getComponentView(k).style.left)||0),j=0;if(A=X.getHTipText(X.$16k),o&&(y.beginPath(),y.fillStyle=C,y.rect(H,j,l,O),y.fill()),s){y.beginPath(),y.textAlign="center",y.textBaseline="middle",y.font=Q;var b=y.measureText(A).width+6;y.fillStyle=R,y.rect(H-b/2,j,b,O),y.fill(),y.strokeStyle=G,y.stroke(),y.beginPath(),y.fillStyle=x,y.fillText(A,H,j+O/2)}y.restore()},getVTipText:function(V){var u=this,S=u._component,d=0,J=u._view.getBoundingClientRect();return S.lp?d=B(S.lp({x:V.x,y:V.y+J.top}).y):d-=B(this.getComponentView(S).style.top)||0,d},formatScaleText:function(Y){return Math.round(Y)},$10k:function(t,y,N,J,l,n,f,z,c,X,b,m){var E=this,j=E._component;t.save(),P.translateAndScale(t,0,0,1);var _=N/2,i=y-(B(this.getComponentView(j).style.top)||0);if(y=E.getVTipText(E.$16k),n&&(t.beginPath(),t.fillStyle=J,t.rect(_-N/2,i,N,l),t.fill()),f){t.translate(_,i),t.rotate((m?90:-90)*g/180),t.translate(-_,-i),t.beginPath(),t.textAlign="center",t.textBaseline="middle",t.font=X;var T=t.measureText(y).width+6;t.fillStyle=b,t.rect(_-T/2,i-N/2,T,N),t.fill(),t.strokeStyle=z,t.stroke(),t.fillStyle=c,t.fillText(y,_,i)}t.restore()},$11k:function(K,Y,a,f,F,u,X,I,v,e,M,C,b){K.save(),a=0;var z=Y,h=f,S=(z+h)/2;Y=0,f=h-z,P.translateAndScale(K,0,0,1);var $=0,i=0,Z=B(u/2),O=u-Z,W=M?0:Z,t=I*X,E=t/10;Y-=t,f+=t,K.clearRect(Y,0,f-Y,u),K.beginPath(),K.fillStyle=b;var n=p(S/E)*E-z;for($=n;f>$;$+=E)K.rect($,a+W,1,O);for($=n;$>Y;$-=E)K.rect($,a+W,1,O);for(K.fill(),W=M?0:1,K.beginPath(),K.fillStyle=C,n=p(S/t)*t-z,$=n;f>$;$+=t)K.rect($,a+W,1,u-1);for($=n;$>Y;$-=t)K.rect($,a+W,1,u-1);K.fill();var w=B(/\d+px/.exec(v)[0]),m=(w||10)/2;K.textBaseline="middle",W=M?u-m-2:m+2,K.beginPath(),K.fillStyle=e,K.font=v;var o=p(S/t)*t/X;for($=n,i=o;f>$;$+=t,i+=I){var Q=this.getHScaleText?this.getHScaleText($):i;K.fillText(this.formatScaleText(Q),$+2,a+W)}for($=n,i=o;$>Y;$-=t,i-=I){var Q=this.getHScaleText?this.getHScaleText($):i;K.fillText(this.formatScaleText(Q),$+2,a+W)}K.restore()},$12k:function(N,T,u,_,b,H,h,l,U,r,X,j,m){function M(R,o,l,i,j,s){j=G.getVScaleText?G.getVScaleText(l):j,j=G.formatScaleText(j),N.translate(R+o,l),N.rotate(-i),N.translate(-R-o,-l),N.fillText(j,R+o+(s?2:1),l),N.translate(R+o,l),N.rotate(i),N.translate(-R-o,-l)}N.save(),T=0;var S=u,O=b,W=(S+O)/2;u=0,b=O-S,P.translateAndScale(N,0,0,1);var t=0,G=this,z=0,i=B(H/2),d=H-i,w=X?0:i,L=l*h,x=L/10;u-=L,b+=L,N.clearRect(T,0,H,b-u),N.beginPath(),N.fillStyle=m;var I=p(W/x)*x-S;for(t=I;b>t;t+=x)N.rect(T+w,t,d,1);for(t=I;t>u;t-=x)N.rect(T+w,t,d,1);for(N.fill(),w=X?0:1,N.beginPath(),N.fillStyle=j,I=p(W/L)*L-S,t=I;b>t;t+=L)N.rect(T+w,t,H-1,1);for(t=I;t>u;t-=L)N.rect(T+w,t,H-1,1);N.fill();var n=B(/\d+px/.exec(U)[0]),A=(n||10)/2,D=90*g/180;N.textBaseline="middle",w=X?H-A:A+2,D=X?-D:D,N.beginPath(),N.fillStyle=r,N.font=U;var e=p(W/L)*L/h;for(t=I,z=e;b>t;t+=L,z+=l)M(T,w,t,D,z,X);for(t=I,z=e;t>u;t-=L,z-=l)M(T,w,t,D,z,X);N.restore()},onPropertyChanged:function(){this.iv()},dispose:function(){var X=this,e=X._component,N=X._view;e&&X.removeComponentPropertyChangeListener(e,X.$14k),N&&($(N,"mousemove",X.$15k),n(N.parentNode,N),X._view=null)}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);