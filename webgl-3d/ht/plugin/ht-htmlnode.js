!function(K){"use strict";var Y="ht",A=K[Y],_=function(){return document},h=function(){return _().body},j=function(m,M,F){m.style.setProperty(M,F,null)},E=function(v){return _().createElement(v)},I=function(){return E("div")},N=function(){var H=E("canvas");return H},R=function($,m){j($,"-webkit-transform",m),j($,"-ms-transform",m),j($,"transform",m)},X=function(k,D){j(k,"-webkit-transform-origin",D),j(k,"-ms-transform-origin",D),j(k,"transform-origin",D)},t=function(p,K){p.appendChild(K)},Z=function(m,E){m.removeChild(E)},B=K.parseInt,D=A.Default,l=D.getInternal(),F=l.addEventListener,x=(l.removeEventListener,Math.PI),Q="white-space",a="visibility",T="left",J="top",n="width",V="height",$="position",u="display",c="z-index",O="px",q="0 0",y="absolute",o="visible",G="hidden",H="none",z="block",d="nowrap",S="rgba(0, 0, 0, 0.005)";D.setImage("node_dragger","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAN9JREFUeNrsV9sNhDAMKyzQVdgARmGzrMJNUFZhAh6nfkVcG9PQgHSR8lEksJs6pnGuLCimSRzAa0yyBK9O4gy8GokU+O0kJOAwiQYg0LP1xNYDW3+0CfBYNb7VOuN4LAGpiOaYUhFDas9F2NPHDELNENJqaHgBgSQJ3ufakfQJqckERcOiK+Ae1FGWBNKGh9oX5WPpLpdNYfffijbsxTHh7VKP7388n1g1h7OKUoUuyGpJakQEuhwkZAKcDXVOdWcrOrL/feBVBHI/q8fcjE1nA9PpyHQ+NJ2Qi8A3AQYAOtS27fCoRY0AAAAASUVORK5CYII=");var i=A.graph.GraphView.prototype,w=i._42;i.adjustHtmlNodeIndex=!0,i._42=function(B,D){if(w.call(this,B,D),this.adjustHtmlNodeIndex)for(var a=this.getDataModel()._datas._as,t=a.length,L=1,e=0;t>e;e++){var p=a[e];if(p instanceof U){var Z=this.getDataUI(p);j(Z.$2f,c,L+""),j(Z.$3f,c,L+1+""),L+=2}}};var L=A.HtmlNodeUI=function(Y,U){var p=this;L.superClass.constructor.call(p,Y,U);var z=p.$2f=I(),o=p.$3f=N();j(z,$,y),j(z,a,G),j(z,Q,d),o.draggable=!1,j(o,$,y),j(o,u,H),X(o,q),F(z,"change",function(s){var W=s.target,f=W.bind||W.getAttribute("bind"),S=W.type&&"checkbox"===W.type?W.checked:W.value,c=U.getContext();f&&c&&(c[f]=S,p.$4f=JSON.stringify(c))}),["mousedown","touchstart","keydown","mousewheel","DOMMouseScroll"].forEach(function(v){F(z,v,this.$9f.bind(this))},p)};D.def(L,l.ui().NodeUI,{_visible:!0,$11f:function(){var O=this,C=O.$3f,j=O._data,i=j.getDraggerImageWidth(),G=j.getDraggerImageHeight(),A=j.getDraggerImage(),v=l.initContext(C);v.beginPath(),l.setCanvas(C,i,G),l.translateAndScale(v,0,0,1),v.clearRect(0,0,i,G),D.drawImage(v,D.getImage(A),0,0,i,G),v.restore()},_80o:function(M){L.superClass._80o.call(this,M);var W=this,f=W._data,A=f._padding,q=2*A,_=W.$2f,m=W.$3f,d=W.gv,E=d.getZoom(),i=d.getTranslateX(),K=d.getTranslateY(),F=d.getView(),b=W._83o,r=f._width,e=f._height,N=b.position,w=b.rotation,v=(r-q)/f.$5f*E,Q=(e-q)/f.$6f*E,P=W._html,C=f._html,Z=f.getHtmlType();if("html"===Z){var k=f.getContext()||{},X=W.$4f,D=f.$10f,U=JSON.stringify(k);P&&X&&P===C&&X===U||(W.$4f=U,W._html=C,_.innerHTML=D?D(k):C)}else if(null!=Z){var p=f.getHtml();"ht"===Z&&(p=p.getView()),P&&P===p&&_.contains(P)||(W._html=p,_.innerHTML="",t(_,p))}if(!_.parentNode){var h=d.$1f;if(!h){var l=I();j(l,$,y),j(l,c,"0"),h=d.$1f=l;var Y=d._canvas.nextSibling;Y?F.insertBefore(l,Y):t(F,l)}t(h,_),t(h,m),f.onContentInitialized&&f.onContentInitialized(_)}if(f._scalable){var s=f.$5f,g=f.$6f;R(_,"rotate("+180*(w/x)+"deg) scale("+v+","+Q+")"),j(_,n,""),j(_,V,""),j(_,T,(N.x-s/E/2)*E+i+O),j(_,J,(N.y-g/E/2)*E+K+O)}else{var Mb=B(_.style.width),Ie=B(_.style.height),Ug=B((r-q)*E),xr=B((e-q)*E),Mi="100%",yi=_.children[0];j(yi,n,Mi),j(yi,V,Mi),(Mb!==Ug||Ie!==xr)&&(j(_,n,Ug+O),j(_,V,xr+O),"ht"===Z&&C.invalidate()),R(_,"rotate("+180*(w/x)+"deg)"),j(_,T,(N.x-Ug/E/2)*E+i+O),j(_,J,(N.y-xr/E/2)*E+K+O)}var ih=W.dragRect;d.isMovable(f)&&d.isSelected(f)&&ih?(M.save(),M.fillStyle=S,M.fillRect(ih.x,ih.y,ih.width,ih.height),M.restore(),j(m,T,ih.x*E+i+O),j(m,J,ih.y*E+K+O),R(m,"scale("+E+","+E+")"),j(m,u,z),W.$11f()):j(m,u,H),j(_,a,this._visible?o:G)},dispose:function(){var U=this.gv.$1f;this.$2f.parentNode===U&&U.removeChild(this.$2f),this.$3f.parentNode===U&&U.removeChild(this.$3f)},_84o:function(e){this._visible=e,j(this.$2f,a,e?o:G),j(this.$3f,u,e?z:H)},_3O:function(){var S=this,c=S.gv,B=S._data;L.superClass._3O.call(S);var U=B.getRect();c.isEditable(B)&&(S.dragRect={x:U.x+U.width+B._padding,y:U.y+10,width:B.getDraggerImageWidth(),height:B.getDraggerImageHeight()},S._68o(S.dragRect))},rectIntersects:function(h){var S=this._79o();return A.Default.intersection(S,h)?!0:void 0},$9f:function(V){var o=this.gv,N=this._data;o.sm().contains(N)&&V.stopPropagation()}});var U=A.HtmlNode=function(){U.superClass.constructor.call(this)};A.Default.def(U,A.Node,{ms_ac:["html","context","scalable","padding","draggerImage","draggerImageWidth","draggerImageHeight"],_padding:A.Default.isTouchable?12:6,_image:null,_scalable:!0,_draggerImage:"node_dragger",_draggerImageWidth:20,_draggerImageHeight:20,setHtml:function(b){var h=this,o=h._html;h._html=b,"html"===h.getHtmlType()&&"Handlebars"in K&&(h.$10f=Handlebars.compile(b)),h.$13f(),h.fp("html",o,b)},setContext:function(m){var $=this,a=$._context;$._context=m,$.fp("context",a,m),$.$13f()},setScalable:function(q){var S=this,M=S._scalable;S._scalable=q,S.fp("scalable",M,q),S.$13f()},getHtmlType:function(){var I=this._html;return I?"string"==typeof I?"html":I.getView?"ht":"dom":null},$13f:function(){var f=this,k=f._html,O=f.$10f;if(k){var w=I(),q=!1,S=f.getHtmlType();if(j(w,$,y),j(w,Q,d),j(w,a,G),"html"===S?(w.innerHTML=O?O(f.getContext()||{}):k,q=!0):"ht"===S?(t(w,k.getView()),q=!0):"dom"===S&&(t(w,k),q=!0),q){var T=2*f._padding;t(h(),w),f.$5f=w.scrollWidth,f.$6f=w.scrollHeight,f._width=f.$5f+T,f._height=f.$6f+T,f._originWidth=f._width,f._originHeight=f._height,Z(h(),w)}}},getUIClass:function(){return A.HtmlNodeUI}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);