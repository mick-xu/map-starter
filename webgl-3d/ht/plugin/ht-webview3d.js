!function(n){"use strict";function w(k){var T,M,p,g,B,r,C,b=[],S=0;T=e.createDiv(),T.style.overflow="hidden";var J=k.getView();J.insertBefore(T,k.getCanvas()),M=E.Default.createDiv(),M.style.WebkitTransformStyle="preserve-3d",M.style.MozTransformStyle="preserve-3d",M.style.transformStyle="preserve-3d",T.appendChild(M),[{event:"mousedown",style:"none"},{event:"mouseup",style:"auto"},{event:"touchstart",style:"none"},{event:"touchend",style:"auto"}].forEach(function(H){var f=H.style;y.addEventListener(J,H.event,function(){T.style.pointerEvents=f})}),this.updateWebView=function(){if(k.getWidth()&&k.getHeight()){var d=k.getCanvas(),c=1*d.style.width.slice(0,-2),I=1*d.style.height.slice(0,-2);(b[0]!==c||b[1]!==I)&&(b[0]=c,b[1]=I,T.style.width=c+"px",T.style.height=I+"px",M.style.width=c+"px",M.style.height=I+"px");var F=k._projectMatrix[5]*b[1]/2;F!==p&&(p=F,T.style.WebkitPerspective=p+"px",T.style.MozPerspective=p+"px",T.style.perspective=p+"px"),r="translateZ("+p+"px)"+m(k._viewMatrix);var Q=r+"translate("+b[0]/2+"px,"+b[1]/2+"px)";g===Q||B||(M.style.WebkitTransform=Q,M.style.MozTransform=Q,M.style.transform=Q,g=Q),S++,C=!1,k.dm().each(function(j){j.isWebView&&G(j)});for(var L,o=M.children,x=[],h=0,W=o.length;W>h;h++)L=o[h],L._isHtWebView&&L._renderCookie!==S&&x.push(L);x.length&&x.forEach(function(F){M.removeChild(F)})}};var o=new Array(16),G=function(_){var A=_.getAttach();if(A){A.parentElement!==M&&M.appendChild(A),A._renderCookie=S,C=!0;var U=_.getFinalScale3d(),e=_._prefrenceSize;e&&e[0]?e[1]||(e[1]=e[0]/U[0]*U[1]):e=[U[0],U[1]],A.style.width=e[0]+"px",A.style.height=e[1]+"px";var q=1/e[0],l=1/e[1],c=1,j=_.mat;o[0]=j[0]*q,o[1]=j[1]*q,o[2]=j[2]*q,o[3]=j[3]*q,o[4]=j[4]*l,o[5]=j[5]*l,o[6]=j[6]*l,o[7]=j[7]*l,o[8]=j[8]*c,o[9]=j[9]*c,o[10]=j[10]*c,o[11]=j[11]*c,o[12]=j[12],o[13]=j[13],o[14]=j[14],o[15]=j[15];var R=F(o,B?"translate("+b[0]/2+"px,"+b[1]/2+"px)"+r:""),X=A.$a2;X!==R&&(A.$a2=R,A.style.WebkitTransform=R,A.style.MozTransform=R,A.style.transform=R)}}}function z(I){return Math.abs(I)<1e-10?0:I}function m(V){var t=V;return"matrix3d("+z(t[0])+","+z(-t[1])+","+z(t[2])+","+z(t[3])+","+z(t[4])+","+z(-t[5])+","+z(t[6])+","+z(t[7])+","+z(t[8])+","+z(-t[9])+","+z(t[10])+","+z(t[11])+","+z(t[12])+","+z(-t[13])+","+z(t[14])+","+z(t[15])+")"}function F(J,w){var Z=J,P="matrix3d("+z(Z[0])+","+z(Z[1])+","+z(Z[2])+","+z(Z[3])+","+z(-Z[4])+","+z(-Z[5])+","+z(-Z[6])+","+z(-Z[7])+","+z(Z[8])+","+z(Z[9])+","+z(Z[10])+","+z(Z[11])+","+z(Z[12])+","+z(Z[13])+","+z(Z[14])+","+z(Z[15])+")";return"translate(-50%,-50%)"+(w||"")+P}var C="ht",E=n[C],e=E.Default,y=e.getInternal(),i=y.superCall,B=E.graph3d.Graph3dView,j=B.prototype.validateImpl;B.prototype.validateImpl=function(){j.call(this);var Z=this._webViewRenderer;Z||(Z=this._webViewRenderer=new w(this)),Z.updateWebView()};var $=E.WebView3d=function(){var Z=this;i($,Z),Z.s({shape3d:"billboard","shape3d.reverse.flip":!0})},o=[1,1,1,1],r=[0,0,0,0];e.def(C+"."+"WebView3d",E.Node,{ms_ac:["attach"],isWebView:!0,attachDOM:function(U,i,q){if(!U)return this.detachDOM();if("string"==typeof U){var L=document.createElement("iframe");L.src=U,U=L}var $=U.style;$.position="absolute",$.border=0,$.outline=0,$.padding=0,$.margin=0,U._isHtWebView=!0,this.setAttach(U),this._prefrenceSize=[i,q],this.s("shape3d.blend",r)},detachDOM:function(){this.setAttach(null),this.s("shape3d.blend",this.getBgColor())},setBgColor:function(S){this.a("defaultBgColor",S),this.getAttach()||this.s("shape3d.blend",S)},getBgColor:function(){return this.a("defaultBgColor")||o}})}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);